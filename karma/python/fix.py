#!/usr/bin/python

import sys
from urlparse import urlparse

sources_by_id = {
                 1: "backpage",
                 2: "craigslist",
                 3: "classivox",
                 4: "myproviderguide",
                 5: "naughtyreviews",
                 6: "redbook",
                 7: "cityvibe",
                 8: "massagetroll",
                 9: "redbook_forum",
                 10: "cityxguide",
                 11: "cityxguideforum",
                 12: "rubads",
                 13: "anunico",
                 14: "sipsap",
                 15: "escortsincollege",
                 16: "escortphonelist",
                 17: "eroticmugshots",
                 18: "escortadsxxx",
                 19: "escortsinca",
                 20: "escortsintheus",
                 21: "liveescortreviews",
                 22: "myproviderguideforum",
                 23: "usasexguide",
                 24: "eroticreview",
                 25: "adultsearch",
                 26: "happymassage",
                 27: "utopiaguide",
                 28: "missingkids",
                 29: "alibaba",
                 30: "justlanded",
                 31: "gmdu",
                 32: "tradekey",
                 33: "manpowervacancy",
                 34: "gulfjobsbank",
                 35: "ec21"}


def clean(x):
    return str(x).replace(' ', '')

def marketid_to_market_tuple(source_columns, marketid):
    minfo = market_id_to_market_info.get(marketid, None)
    if not minfo:
        print >> sys.stderr, "Need to define a tuple for FAA/ICAO %s" % marketid
        return None
    else:
        locality = minfo[2]
        adm1 = minfo[1]
        country = minfo[0]
        return [source_columns] + minfo

### BACKPAGE

backpage_sitekey_to_marketid = {
                                "abbotsford": "YXX",
                                "aberdeen": "ABZ",
                                "abilene": "ABI",
                                "acapulco": "ACA",
                                "adelaide": "ADL",
                                "ahmedabad": "AMD",
                                "akroncanton": "CAK",
                                "alabama": "BHM",
                                "albany": "ALB",
                                "albanyga": "ABY",
                                "alberta": "YEG",
                                "albuquerque": "ABQ",
                                "alexandria": "ESF",
                                "alicante": "ALC",
                                "allentown": "ABE",
                                "altoona": "AOO",
                                "amarillo": "AMA",
                                "amsterdam": "AMS",
                                "anchorage": "ANC",
                                "annapolis": "ANP",
                                "annarbor": "ARB",
                                "appleton": "ATW",
                                "arizona": "PHX",
                                "arkansas": "LIT",
                                "arlington": "DFW",
                                "asheville": "AVL",
                                "ashtabula": "HZY",
                                "athensga": "AHN",
                                "athensoh": "ATO",
                                "athina": "ATH",
                                "atlanta": "ATL",
                                "auburn": "AUO",
                                "auckland": "AKL",
                                "augusta": "AGS",
                                "austin": "AUS",
                                "bahamas": "NAS",
                                "bahia": "SSA",
                                "bajasur": "SJD",
                                "bakersfield": "BFL",
                                "baleares": "PMI",
                                "balgariya": "SOF",
                                "baltimore": "BWI",
                                "bangalore": "BLR",
                                "bangladesh": "DAC",
                                "barcelona": "BCN",
                                "barrie": "QEB",
                                "basel": "BSL",
                                "batonrouge": "BTR",
                                "battlecreek": "AZO",
                                "beaumont": "BPT",
                                "beijing": "PEK",
                                "belfast": "BFS",
                                "belleville": "YTR",
                                "bellingham": "BLI",
                                "belohorizonte": "CNF",
                                "bemidji": "BJI",
                                "bend": "RDM",
                                "berlin": "TXL",
                                "bern": "BRN",
                                "bhubaneswar": "BBI",
                                "bigisland": "KOA",
                                "bilbao": "BIO",
                                "biloxi": "GPT",
                                "binghamton": "BGM",
                                "birmingham": "BHM",
                                "birminghamuk": "BHX",
                                "bismarck": "BIS",
                                "blacksburg": "BCB",
                                "bloomington": "BMI",
                                "bloomingtonin": "BMG",
                                "boise": "BOI",
                                "bologna": "BLQ",
                                "boone": "NC06",
                                "bordeaux": "BOD",
                                "boston": "BOS",
                                "boulder": "WBU",
                                "bowlinggreen": "BWG",
                                "brantford": "YFD",
                                "brasilia": "BSB",
                                "bremen": "BRE",
                                "bretagne": "RNS",
                                "brighton": "ESH",
                                "brisbane": "BNE",
                                "bristol": "BRS",
                                "britishcolumbia": "YVR",
                                "bronx": "JFK",
                                "brooklyn": "JFK",
                                "brownsville": "BRO",
                                "brunswick": "BQK",
                                "brussel": "BRU",
                                "bucuresti": "OTP",
                                "budapest": "BUD",
                                "buenosaires": "EZE",
                                "buffalo": "BUF",
                                "burlington": "BTV",
                                "cadiz": "XRY",
                                "calabria": "REG",
                                "calgary": "YYC",
                                "cambridge": "CBG",
                                "canarias": "TFS",
                                "canberra": "CBR",
                                "capecod": "PVC",
                                "capetown": "CPT",
                                "caracas": "CCS",
                                "carbondale": "MDH",
                                "caribbean": "KIN",
                                "cariboo": "YXS",
                                "catskills": "20N",
                                "cedarrapids": "CID",
                                "centraljersey": "47N",
                                "centralmich": "LAN",
                                "chambana": "CMI",
                                "chambersburg": "N68",
                                "chandigarh": "IXC",
                                "charleston": "CHS",
                                "charlestonwv": "CRW",
                                "charlotte": "CLT",
                                "charlottesville": "CHO",
                                "chatham": "XCM",
                                "chattanooga": "CHA",
                                "chautauqua": "JHW",
                                "chengdu": "CTU",
                                "chennai": "MAA",
                                "chesapeake": "ORF",
                                "chicago": "ORD",
                                "chico": "CIC",
                                "chihuahua": "CUU",
                                "chillicothe": "RZT",
                                "chongqing": "CKG",
                                "christchurch": "CHC",
                                "cincinnati": "CVG",
                                "clarksville": "CKV",
                                "cleveland": "CLE",
                                "clovis": "CVN",
                                "collegestation": "CLL",
                                "colombia": "BOG",
                                "colorado": "DEN",
                                "coloradosprings": "COS",
                                "columbia": "CAE",
                                "columbiamo": "COU",
                                "columbus": "CMH",
                                "columbusga": "CSG",
                                "comoxvalley": "YQQ",
                                "connecticut": "HFD",
                                "cookeville": "SRB",
                                "cork": "ORK",
                                "cornwall": "YCC",
                                "corpuschristi": "CRP",
                                "corse": "AJA",
                                "corvallis": "CVO",
                                "costarica": "SJO",
                                "cranbrook": "YXC",
                                "cumberlandvalley": "CBE",
                                "curitiba": "CWB",
                                "dalian": "DLC",
                                "dallas": "DFW",
                                "danville": "DAN",
                                "darwin": "DRW",
                                "dayton": "DAY",
                                "daytona": "DAB",
                                "dc": "IAD",
                                "decatur": "DEC",
                                "delaware": "ILG",
                                "delhi": "DEL",
                                "delrio": "DRT",
                                "denhaag": "RTM",
                                "denton": "DFW",
                                "denver": "DEN",
                                "derry": "LDY",
                                "desmoines": "DSM",
                                "detroit": "DTW",
                                "devon": "EXT",
                                "dom-tom": "PTP",
                                "dominican": "SDQ",
                                "dothan": "DHN",
                                "dresden": "DRS",
                                "dubai": "DXB",
                                "dublin": "DUB",
                                "dubuque": "DBQ",
                                "duesseldorf": "DUS",
                                "duluth": "DLH",
                                "dunedin": "DUD",
                                "durban": "DUR",
                                "eastanglia": "NWI",
                                "eastbay": "OAK",
                                "easternnc": "PGV",
                                "easternshore": "SBY",
                                "eastidaho": "IDA",
                                "eastky": "PBX",
                                "eastmidlands": "EMA",
                                "eastoregon": "PDT",
                                "eauclaire": "EAU",
                                "edinburgh": "EDI",
                                "edmonton": "YEG",
                                "eindhoven": "EIN",
                                "elko": "EKO",
                                "elmira": "ELM",
                                "elpaso": "ELP",
                                "elsalvador": "SAL",
                                "erie": "ERI",
                                "essen": "ESS",
                                "eugene": "EUG",
                                "evansville": "EVV",
                                "everett": "PAE",
                                "fairfield": "BDR",
                                "fargo": "FAR",
                                "farmington": "FMN",
                                "faro-algarve": "FAO",
                                "fayetteville": "XNA",
                                "fayettevillenc": "FAY",
                                "fingerlakes": "D82",
                                "firenze": "FLR",
                                "flagstaff": "FLG",
                                "flint": "FNT",
                                "florence": "FLO",
                                "forli-cesena": "FRL",
                                "fortaleza": "FOR",
                                "fortcollins": "FNL",
                                "fortdodge": "FOD",
                                "fortmyers": "RSW",
                                "fortsmith": "FSM",
                                "fortwayne": "FWA",
                                "fortworth": "DFW",
                                "frankfurt": "FRA",
                                "frederick": "FDK",
                                "fredericksburg": "EZF",
                                "fresno": "FAT",
                                "ftlauderdale": "FLL",
                                "ftmcmurray": "YMM",
                                "fukuoka": "FUK",
                                "gadsden": "GAD",
                                "gainesville": "GNV",
                                "galveston": "GLS",
                                "genf": "GVA",
                                "genova": "GOA",
                                "georgia": "ATL",
                                "glasgow": "GLA",
                                "glensfalls": "GFL",
                                "goa": "GOI",
                                "granada": "GRX",
                                "grandforks": "GFK",
                                "grandisland": "GRI",
                                "grandrapids": "GRR",
                                "greenbay": "GRB",
                                "greensboro": "GSO",
                                "greenville": "GSP",
                                "grenoble": "GNB",
                                "guadalajara": "GDL",
                                "guam": "GUM",
                                "guanajuato": "BJX",
                                "guangzhou": "CAN",
                                "guatemala": "GUA",
                                "guelph": "CNC4",
                                "haifa": "HFA",
                                "halifax": "YHZ",
                                "hamburg": "HAM",
                                "hamilton": "YHM",
                                "hampshire": "SOU",
                                "hampton": "ORF",
                                "hangzhou": "HGH",
                                "hannover": "HAJ",
                                "harrisburg": "MDT",
                                "harrisonburg": "SHD",
                                "hartford": "HFD",
                                "hattiesburg": "HBG",
                                "hawaii": "HNL",
                                "heidelberg": "HDB",
                                "helsinki": "HEL",
                                "hermosillo": "HMO",
                                "hickory": "HKY",
                                "hiltonhead": "HHH",
                                "hiroshima": "HIJ",
                                "hobart": "HBA",
                                "holland": "BIV",
                                "hongkong": "HKG",
                                "honolulu": "HNL",
                                "houma": "HUM",
                                "houston": "IAH",
                                "hudsonvalley": "SWF",
                                "humboldt": "ACV",
                                "huntington": "HTS",
                                "huntingtonoh": "HTS",
                                "huntsville": "HSV",
                                "huntsvilletx": "UTS",
                                "hyderabad": "HYD",
                                "iceland": "RKV",
                                "idaho": "BOI",
                                "illinois": "ORD",
                                "imperial": "IPL",
                                "indiana": "IND",
                                "indianapolis": "IND",
                                "indore": "IDR",
                                "inlandempire": "ONT",
                                "iowa": "DSM",
                                "iowacity": "IOW",
                                "istanbul": "IST",
                                "ithaca": "ITH",
                                "jackson": "JAN",
                                "jacksonmi": "JXN",
                                "jacksonville": "OAJ",
                                "jaipur": "JAI",
                                "jakarta": "CGK",
                                "jamaica": "KIN",
                                "janesville": "JVL",
                                "jerseyshore": "ACY",
                                "jerusalem": "JRS",
                                "johannesburg": "JNB",
                                "jonesboro": "JBR",
                                "joplin": "JLN",
                                "juarez": "XRY",
                                "kaiserslautern": "RMS",
                                "kalamazoo": "AZO",
                                "kamloops": "YKA",
                                "kansas": "FOE",
                                "karlsruhe": "FKB",
                                "kauai": "LIH",
                                "kc": "MCI",
                                "kelowna": "YLW",
                                "kentucky": "SDF",
                                "kerala": "TRV",
                                "keys": "EYW",
                                "kiel": "KEL",
                                "killeen": "GRK",
                                "kingston": "YGK",
                                "kirksville": "IRK",
                                "kitchener": "YKF",
                                "klamath": "LMT",
                                "knoxville": "TYS",
                                "kobenhavn": "CPH",
                                "koeln": "CGN",
                                "kokomo": "OKK",
                                "kolkata": "CCU",
                                "lacrosse": "LSE",
                                "lafayette": "LFT",
                                "lakecharles": "LCH",
                                "lakeland": "LAL",
                                "lancaster": "LNS",
                                "lansing": "LAN",
                                "lapaz": "LPB",
                                "laredo": "LRD",
                                "lasalle": "VYS",
                                "lascruces": "LRU",
                                "lasvegas": "LAS",
                                "lausanne": "QLS",
                                "lawrence": "LWC",
                                "lawton": "LAW",
                                "leeds": "LBA",
                                "leipzig": "LEJ",
                                "lethbridge": "YQL",
                                "lewiston": "LWS",
                                "lexington": "LEX",
                                "lille": "LIL",
                                "lima": "LIM",
                                "limaoh": "AOH",
                                "limerick": "SNN",
                                "lincoln": "LNK",
                                "lisboa": "LIS",
                                "lisburn": "BFS",
                                "littlerock": "LIT",
                                "liverpool": "LPL",
                                "logan": "LGU",
                                "loire": "NTE",
                                "london": "LHR",
                                "londonon": "YXU",
                                "longbeach": "LGB",
                                "longisland": "ISP",
                                "losangeles": "LAX",
                                "louisiana": "MSY",
                                "louisville": "SDF",
                                "loz": "AIZ",
                                "lubbock": "LBB",
                                "lucknow": "LKO",
                                "luebeck": "LBC",
                                "luxembourg": "LUX",
                                "lynchburg": "LYH",
                                "lyon": "LYS",
                                "macon": "MCN",
                                "madison": "MSN",
                                "madrid": "MAD",
                                "maine": "PWM",
                                "malaga": "AGP",
                                "malaysia": "KUL",
                                "malta": "MLA",
                                "managua": "MGA",
                                "manchester": "MAN",
                                "manhattan": "JFK",
                                "manhattanks": "MHK",
                                "mankato": "MKT",
                                "mannheim": "MHG",
                                "mansfield": "MFD",
                                "marseille": "MRS",
                                "martinsburg": "MRB",
                                "maryland": "BWI",
                                "masoncity": "MCW",
                                "massachusetts": "BOS",
                                "mattoon": "MTO",
                                "maui": "OGG",
                                "mazatlan": "MZT",
                                "mcallen": "MFE",
                                "meadville": "GKJ",
                                "medford": "MFR",
                                "medicinehat": "YXH",
                                "melbourne": "MEL",
                                "memphis": "MEM",
                                "mendocino": "UKI",
                                "merced": "MCE",
                                "meridian": "MEI",
                                "mexicocity": "MEX",
                                "miami": "MIA",
                                "michigan": "DTW",
                                "milano": "MXP",
                                "milwaukee": "MKE",
                                "minneapolis": "MSP",
                                "minnesota": "MSP",
                                "minot": "MOT",
                                "mississippi": "JAN",
                                "missouri": "STL",
                                "mobile": "MOB",
                                "modesto": "MOD",
                                "mohave": "IGM",
                                "monroe": "MLU",
                                "monroemi": "TTF",
                                "montana": "HLN",
                                "monterey": "MRY",
                                "monterrey": "MTY",
                                "montevideo": "MVD",
                                "montgomery": "MGM",
                                "montpellier": "MPL",
                                "montreal": "YUL",
                                "morgantown": "MGW",
                                "morocco": "CMN",
                                "moseslake": "MWH",
                                "moskva": "SVO",
                                "mtvernon": "BVS",
                                "muenchen": "MUC",
                                "mumbai": "BOM",
                                "muncie": "MIE",
                                "muskegon": "MKG",
                                "myrtlebeach": "MYR",
                                "nagoya": "NGO",
                                "nanaimo": "YCD",
                                "nanjing": "NKG",
                                "napoli": "NAP",
                                "nashville": "BNA",
                                "natchez": "HEZ",
                                "nebraska": "OMA",
                                "nevada": "LAS",
                                "newbrunswick": "YQM",
                                "newcastle": "NCL",
                                "newhampshire": "MHT",
                                "newhaven": "HVN",
                                "newjersey": "EWR",
                                "newlondon": "GON",
                                "newmexico": "ABQ",
                                "neworleans": "MSY",
                                "newportnews": "ORF",
                                "newyork": "JFK",
                                "niagara": "YCM",
                                "nice": "NCE",
                                "nigeria": "LOS",
                                "norfolk": "ORF",
                                "normandie": "URO",
                                "northbay": "STS",
                                "northcarolina": "CLT",
                                "northdakota": "FAR",
                                "northernmichigan": "TVC",
                                "northjersey": "EWR",
                                "northmiss": "TUP",
                                "northplatte": "LBF",
                                "nova": "IAD",
                                "nuernberg": "NUE",
                                "nwct": "DXR",
                                "nwga": "RMG",
                                "oaxaca": "OAX",
                                "ocala": "OCF",
                                "odessa": "MAF",
                                "ogden": "OGD",
                                "ohio": "CMH",
                                "okinawa": "OKA",
                                "oklahoma": "OKC",
                                "oklahomacity": "OKC",
                                "olympia": "TCM",
                                "omaha": "OMA",
                                "oneonta": "ONH",
                                "ontario": "YOW",
                                "orangecounty": "SNA",
                                "oregon": "PDX",
                                "oregoncoast": "ONP",
                                "orlando": "MCO",
                                "osaka-kobe-kyoto": "KIX",
                                "oslo": "OSL",
                                "ottawa": "YOW",
                                "ottumwa": "OTM",
                                "outerbanks": "FFA",
                                "owensboro": "OWB",
                                "owensound": "YOS",
                                "oxford": "OXF",
                                "pakistan": "KHI",
                                "palma": "PMI",
                                "palmdale": "PMD",
                                "palmsprings": "PSP",
                                "panama": "PAC",
                                "panamacity": "PFN",
                                "paris": "CDG",
                                "parkersburg": "PKB",
                                "peace": "YPE",
                                "pennstate": "UNV",
                                "pennsylvania": "PHL",
                                "pensacola": "PNS",
                                "peoria": "PIA",
                                "perth": "PER",
                                "perugia": "PEG",
                                "peterborough": "YPQ",
                                "philadelphia": "PHL",
                                "phoenix": "PHX",
                                "pittsburgh": "PIT",
                                "plattsburgh": "PBG",
                                "poconos": "MPO",
                                "porthuron": "PHN",
                                "portland": "PDX",
                                "porto": "OPO",
                                "portoalegre": "POA",
                                "portsmouth": "ORF",
                                "potsdam": "PTD",
                                "praha": "PRG",
                                "prescott": "PRC",
                                "pretoria": "PRY",
                                "princegeorge": "YXS",
                                "providence": "PVD",
                                "provo": "PVU",
                                "puebla": "PBC",
                                "pueblo": "PUB",
                                "puertorico": "SJU",
                                "pullman": "PUW",
                                "pune": "PNQ",
                                "pv": "PVR",
                                "quadcities": "MLI",
                                "quebec": "YUL",
                                "quebeccity": "YQB",
                                "queens": "JFK",
                                "quincy": "UIN",
                                "quito": "UIO",
                                "racine": "RAC",
                                "raleigh": "RDU",
                                "reading": "RDG",
                                "recife": "REC",
                                "reddeer": "YQF",
                                "redding": "RDD",
                                "regina": "YQR",
                                "reno": "RNO",
                                "richmond": "RIC",
                                "richmondin": "RID",
                                "riodejaneiro": "GIG",
                                "roanoke": "ROA",
                                "rochester": "ROC",
                                "rochestermn": "RST",
                                "rockford": "RFD",
                                "rockies": "EGE",
                                "roma": "FCO",
                                "roseburg": "RBG",
                                "rostock": "RLG",
                                "roswell": "ROW",
                                "rotterdam": "RTM",
                                "sacramento": "SMF",
                                "saginaw": "MBS",
                                "saguenay": "YBG",
                                "salem": "SLE",
                                "saltlakecity": "SLC",
                                "salvador": "SSA",
                                "sanantonio": "SAT",
                                "sandiego": "SAN",
                                "sandusky": "SKY",
                                "sanfernandovalley": "BUR",
                                "sangabrielvalley": "EMT",
                                "sanjose": "SJC",
                                "sankt-peterburg": "LED",
                                "sanluisobispo": "SBP",
                                "sanmarcos": "HYI",
                                "sanmateo": "SQL",
                                "santabarbara": "SBA",
                                "santacruz": "WVI",
                                "santafe": "SAF",
                                "santamaria": "SMX",
                                "santiago": "SCL",
                                "saopaulo": "GRU",
                                "sapporo": "CTS",
                                "sarasota": "SRQ",
                                "sardegna": "CAG",
                                "sarnia": "YZR",
                                "saskatchewan": "YQR",
                                "saskatoon": "YXE",
                                "sault": "YAM",
                                "savannah": "SAV",
                                "schwerin": "SZW",
                                "scottsbluff": "BFF",
                                "scranton": "AVP",
                                "seattle": "SEA",
                                "semo": "CGI",
                                "sendai": "SDJ",
                                "seoul": "ICN",
                                "sevilla": "SVQ",
                                "sf": "SFO",
                                "shanghai": "SHA",
                                "sheboygan": "SBM",
                                "sheffield": "DSA",
                                "shenyang": "SHE",
                                "shenzhen": "SZX",
                                "sherbrooke": "YSC",
                                "shoals": "MSL",
                                "showlow": "SOW",
                                "shreveport": "SHV",
                                "sicilia": "PMO",
                                "sierravista": "FHU",
                                "singapore": "SIN",
                                "siouxcity": "SUX",
                                "siskiyou": "SIY",
                                "skeena": "XCM",
                                "southbend": "SBN",
                                "southcarolina": "CAE",
                                "southcoast": "EWB",
                                "southdakota": "PIR",
                                "southernmaryland": "2W6",
                                "southernwestvirginia": "BKW",
                                "southjersey": "MIV",
                                "spacecoast": "TIX",
                                "spokane": "GEG",
                                "springfield": "CEF",
                                "springfieldil": "SPI",
                                "springfieldmo": "SGF",
                                "statenisland": "JFK",
                                "statesboro": "TBR",
                                "staugustine": "UST",
                                "stcloud": "STC",
                                "stgeorge": "SGU",
                                "stillwater": "SWO",
                                "stjohns": "YYT",
                                "stjoseph": "STJ",
                                "stlouis": "STL",
                                "stockholm": "ARN",
                                "stockton": "SCK",
                                "strasbourg": "SXB",
                                "stuttgart": "STR",
                                "sudbury": "YSB",
                                "suffolk": "ORF",
                                "sunshine": "YHS",
                                "surat": "STV",
                                "susanville": "SVE",
                                "swmi": "BEH",
                                "swva": "MKJ",
                                "sydney": "SYD",
                                "syracuse": "SYR",
                                "tacoma": "TCM",
                                "taipei": "TPE",
                                "tallahassee": "TLH",
                                "tampa": "TPA",
                                "telaviv": "TLV",
                                "tennessee": "BNA",
                                "terrehaute": "HUF",
                                "texarkana": "TXK",
                                "texoma": "GYI",
                                "thunderbay": "YQT",
                                "tijuana": "TIJ",
                                "tippecanoe": "LAF",
                                "tokyo": "NRT",
                                "toledo": "TOL",
                                "topeka": "FOE",
                                "torino": "TRN",
                                "toronto": "YYZ",
                                "toulouse": "TLS",
                                "treasurecoast": "VRB",
                                "tricities": "TRI",
                                "tricitieswa": "PSC",
                                "troisrivieres": "YRQ",
                                "tucson": "TUS",
                                "tulsa": "TUL",
                                "tuscaloosa": "TCL",
                                "tuscarawas": "PHD",
                                "twinfalls": "TWF",
                                "twintiers": "OLE",
                                "tyler": "TYR",
                                "ukraine": "IEV",
                                "up": "MQT",
                                "utah": "SLC",
                                "utica": "UCA",
                                "utrecht": "AMS",
                                "valdosta": "VLD",
                                "valencia": "VLC",
                                "vancouver": "YVR",
                                "venezia": "VCE",
                                "ventura": "OXR",
                                "veracruz": "VER",
                                "victoria": "YYJ",
                                "victoriatx": "VCT",
                                "virginia": "RIC",
                                "virginiabeach": "ORF",
                                "virginislands": "STT",
                                "visalia": "VIS",
                                "waco": "ACT",
                                "wales": "CWL",
                                "warszawa": "WAW",
                                "washington": "SEA",
                                "washingtondc": "IAD",
                                "waterford": "WAT",
                                "waterloo": "YKF",
                                "watertown": "ART",
                                "wausau": "AUW",
                                "wellington": "WLG",
                                "wenatchee": "EAT",
                                "westbank": "JRS",
                                "westchester": "HPN",
                                "westernmaryland": "CBE",
                                "westky": "PAH",
                                "westpalmbeach": "PBI",
                                "westslope": "GJT",
                                "westvirginia": "CRW",
                                "wheeling": "HLG",
                                "whistler": "YWS",
                                "whitehorse": "YXY",
                                "wichita": "ICT",
                                "wichitafalls": "SPS",
                                "wien": "VIE",
                                "williamsport": "IPT",
                                "wilmington": "ILM",
                                "windsor": "YQG",
                                "winnipeg": "YWG",
                                "winstonsalem": "INT",
                                "wisconsin": "MKE",
                                "worcester": "ORH",
                                "wuhan": "WUH",
                                "wyoming": "CPR",
                                "xian": "XIY",
                                "yakima": "YKM",
                                "yellowknife": "YZF",
                                "york": "THV",
                                "youngstown": "YNG",
                                "yucatan": "MID",
                                "yuma": "YUM",
                                "zanesville": "ZZV",
                                "zurich": "ZRH"}

def backpage_url_to_sitekey(url):
    """http://longisland.backpage.com/FemaleEscorts/s-mny-oo-chics-but-oo-nn-lik-oo-me-19/40317377"""
    (scheme, netloc, path, params, query, fragment) = urlparse(url)
    sitekey = netloc.split('.')[0]
    return sitekey

def determineMarketBackpage(url, title, city, state):
    return marketid_to_market_tuple("url",backpage_sitekey_to_marketid[backpage_url_to_sitekey(url)])

### CRAIGSLIST

craigslist_sitekey_to_marketid = {
    "abbotsford": "YXX",
    "aberdeen": "ABZ",
    "abilene": "ABI",
    "acapulco": "ACA",
    "accra": "ACC",
    "addisababa": "ADD",
    "adelaide": "ADL",
    "ahmedabad": "AMD",
    "akroncanton": "CAK",
    "albany": "ALB",
    "albanyga": "ABY",
    "albuquerque": "ABQ",
    "alicante": "ALC",
    "allentown": "ABE",
    "altoona": "AOO",
    "amarillo": "AMA",
    "ames": "AMW",
    "amsterdam": "AMS",
    "anchorage": "ANC",
    "annapolis": "ANP",
    "annarbor": "ARB",
    "appleton": "ATW",
    "asheville": "AVL",
    "ashtabula": "HZY",
    "athens": "ATH",
    "athensga": "AHN",
    "athensohio": "ATO",
    "atlanta": "ATL",
    "auburn": "AUO",
    "auckland": "AKL",
    "augusta": "AGS",
    "austin": "AUS",
    "bacolod": "BCD",
    "baghdad": "BGW",
    "bajasur": "SJD",
    "bakersfield": "BFL",
    "baleares": "PMI",
    "baltimore": "BWI",
    "bangalore": "BLR",
    "bangkok": "BKK",
    "bangladesh": "DAC",
    "barcelona": "BCN",
    "barrie": "QEB",
    "basel": "BSL",
    "bath": "BRS",
    "batonrouge": "BTR",
    "battlecreek": "AZO",
    "beaumont": "BPT",
    "beijing": "PEK",
    "beirut": "BEY",
    "belfast": "BFS",
    "belleville": "YTR",
    "bellingham": "BLI",
    "belohorizonte": "CNF",
    "bemidji": "BJI",
    "bend": "",
    "berlin": "TXL",
    "bern": "BRN",
    "bgky": "BWG",
    "bham": "BHM",
    "bhubaneswar": "BBI",
    "bigbend": "ALE",
    "bilbao": "BIO",
    "billings": "BIL",
    "binghamton": "BGM",
    "birmingham": "BHX",
    "bismarck": "BIS",
    "blacksburg": "BCB",
    "bloomington": "BMG",
    "bn": "BMI",
    "boise": "BOI",
    "bologna": "BLQ",
    "boone": "NC06",
    "bordeaux": "BOD",
    "boston": "BOS",
    "boulder": "WBU",
    "bozeman": "BZN",
    "brainerd": "BRD",
    "brantford": "YFD",
    "brasilia": "BSB",
    "bremen": "BRE",
    "brighton": "ESH",
    "brisbane": "BNE",
    "bristol": "BRS",
    "brownsville": "BRO",
    "brunswick": "BQK",
    "brussels": "BRU",
    "bucharest": "OTP",
    "budapest": "BUD",
    "buenosaires": "EZE",
    "buffalo": "BUF",
    "bulgaria": "SOF",
    "burlington": "BTV",
    "butte": "BTM",
    "cadiz": "XRY",
    "cairns": "CNS",
    "cairo": "CAI",
    "calgary": "YYC",
    "cambridge": "CBG",
    "canarias": "TFS",
    "canberra": "CBR",
    "capecod": "PVC",
    "capetown": "CPT",
    "caracas": "CCS",
    "carbondale": "MDH",
    "cardiff": "CWL",
    "caribbean": "KIN",
    "cariboo": "YXS",
    "casablanca": "CMN",
    "catskills": "20N",
    "cdo": "CGY",
    "cebu": "CEB",
    "cedarrapids": "CID",
    "cenla": "ESF",
    "centralmich": "LAN",
    "cfl": "SEF",
    "chambana": "CMI",
    "chambersburg": "N68",
    "chandigarh": "IXC",
    "charleston": "CHS",
    "charlestonwv": "CRW",
    "charlotte": "CLT",
    "charlottesville": "CHO",
    "chatham": "XCM",
    "chattanooga": "CHA",
    "chautauqua": "JHW",
    "chengdu": "CTU",
    "chennai": "MAA",
    "chicago": "ORD",
    "chico": "CIC",
    "chihuahua": "CUU",
    "chillicothe": "RZT",
    "chongqing": "CKG",
    "christchurch": "CHC",
    "cincinnati": "CVG",
    "clarksville": "CKV",
    "cleveland": "CLE",
    "clovis": "CVN",
    "cnj": "47N",
    "collegestation": "CLL",
    "cologne": "CGN",
    "colombia": "BOG",
    "columbia": "CAE",
    "columbiamo": "COU",
    "columbus": "CMH",
    "columbusga": "CSG",
    "comoxvalley": "YQQ",
    "cookeville": "SRB",
    "copenhagen": "CPH",
    "cornwall": "YCC",
    "corpuschristi": "CRP",
    "corvallis": "CVO",
    "cosprings": "COS",
    "costarica": "SJO",
    "cotedazur": "NCE",
    "coventry": "CVT",
    "cranbrook": "YXC",
    "csd": "PIR",
    "curitiba": "CWB",
    "dalian": "DLC",
    "dallas": "DFW",
    "danville": "DAN",
    "darwin": "DRW",
    "davaocity": "DVO",
    "dayton": "DAY",
    "daytona": "DAB",
    "decatur": "DEC",
    "delaware": "ILG",
    "delhi": "DEL",
    "delrio": "DRT",
    "denver": "DEN",
    "derby": "EMA",
    "desmoines": "DSM",
    "detroit": "DTW",
    "devon": "EXT",
    "dothan": "DHN",
    "dresden": "DRS",
    "dubai": "DXB",
    "dublin": "DUB",
    "dubuque": "DBQ",
    "duluth": "DLH",
    "dundee": "DND",
    "dunedin": "DUD",
    "durban": "DUR",
    "dusseldorf": "DUS",
    "eastco": "LIC",
    "easternshore": "SBY",
    "eastidaho": "IDA",
    "eastky": "PBX",
    "eastmids": "EMA",
    "eastnc": "PGV",
    "eastoregon": "PDT",
    "easttexas": "TYR",
    "eauclaire": "EAU",
    "edinburgh": "EDI",
    "edmonton": "YEG",
    "elko": "EKO",
    "elmira": "ELM",
    "elpaso": "ELP",
    "elsalvador": "SAL",
    "enid": "END",
    "erie": "ERI",
    "essen": "ESS",
    "essex": "STN",
    "eugene": "EUG",
    "evansville": "EVV",
    "fairbanks": "FAI",
    "fargo": "FAR",
    "farmington": "FMN",
    "faro": "FAO",
    "fayar": "XNA",
    "fayetteville": "FAY",
    "fingerlakes": "D82",
    "flagstaff": "FLG",
    "flint": "FNT",
    "florence": "FLR",
    "florencesc": "FLO",
    "fortaleza": "FOR",
    "fortcollins": "FNL",
    "fortdodge": "FOD",
    "fortlauderdale": "FLL",
    "fortmyers": "RSW",
    "fortsmith": "FSM",
    "fortwayne": "FWA",
    "frankfurt": "FRA",
    "frederick": "FDK",
    "fredericksburg": "EZF",
    "fresno": "FAT",
    "ftmcmurray": "YMM",
    "fukuoka": "FUK",
    "gadsden": "GAD",
    "gainesville": "GNV",
    "galveston": "GLS",
    "geneva": "GVA",
    "genoa": "GOA",
    "glasgow": "GLA",
    "glensfalls": "GFL",
    "goa": "GOI",
    "goldcoast": "OOL",
    "goldcountry": "O22",
    "granada": "GRX",
    "grandforks": "GFK",
    "grandisland": "GRI",
    "grandrapids": "GRR",
    "greatfalls": "GTF",
    "greenbay": "GRB",
    "greensboro": "GSO",
    "greenville": "GSP",
    "grenoble": "GNB",
    "guadalajara": "GDL",
    "guanajuato": "BJX",
    "guangzhou": "CAN",
    "guatemala": "GUA",
    "guelph": "",
    "gulfport": "GPT",
    "haifa": "HFA",
    "halifax": "YHZ",
    "hamburg": "HAM",
    "hamilton": "YHM",
    "hampshire": "SOU",
    "hanford": "HJO",
    "hangzhou": "HGH",
    "hannover": "HAJ",
    "harrisburg": "MDT",
    "harrisonburg": "SHD",
    "hartford": "HFD",
    "hat": "YXH",
    "hattiesburg": "HBG",
    "heidelberg": "HDB",
    "helena": "HLN",
    "helsinki": "HEL",
    "hermosillo": "HMO",
    "hickory": "HKY",
    "hiltonhead": "HHH",
    "hiroshima": "HIJ",
    "hobart": "HBA",
    "holland": "BIV",
    "hongkong": "HKG",
    "honolulu": "HNL",
    "houma": "HUM",
    "houston": "IAH",
    "hudsonvalley": "SWF",
    "humboldt": "ACV",
    "huntington": "HTS",
    "huntsville": "HSV",
    "hyderabad": "HYD",
    "iloilo": "ILO",
    "imperial": "IPL",
    "indianapolis": "IND",
    "indore": "IDR",
    "inlandempire": "ONT",
    "iowacity": "IOW",
    "istanbul": "IST",
    "ithaca": "ITH",
    "jackson": "JAN",
    "jacksontn": "MKL",
    "jacksonville": "JAX",
    "jaipur": "JAI",
    "jakarta": "CGK",
    "janesville": "JVL",
    "jerseyshore": "ACY",
    "jerusalem": "",
    "johannesburg": "JNB",
    "jonesboro": "JBR",
    "joplin": "JLN",
    "juarez": "CJS",
    "juneau": "JNU",
    "jxn": "JXN",
    "kaiserslautern": "RMS",
    "kalamazoo": "AZO",
    "kalispell": "FCA",
    "kamloops": "YKA",
    "kansascity": "MCI",
    "kelowna": "YLW",
    "kenai": "ENA",
    "kent": "LYX",
    "kenya": "NBO",
    "kerala": "TRV",
    "keys": "EYW",
    "killeen": "GRK",
    "kingston": "YGK",
    "kirksville": "IRK",
    "kitchener": "YKF",
    "klamath": "LMT",
    "knoxville": "TYS",
    "kokomo": "OKK",
    "kolkata": "CCU",
    "kpr": "PSC",
    "ksu": "MHK",
    "kuwait": "KWI",
    "lacrosse": "LSE",
    "lafayette": "LFT",
    "lakecharles": "LCH",
    "lakecity": "LCQ",
    "lakeland": "LAL",
    "lancaster": "LNS",
    "lansing": "LAN",
    "lapaz": "LPB",
    "laredo": "LRD",
    "lasalle": "VYS",
    "lascruces": "LRU",
    "lasvegas": "LAS",
    "lausanne": "",
    "lawrence": "LWC",
    "lawton": "LAW",
    "leeds": "LBA",
    "leipzig": "LEJ",
    "lethbridge": "YQL",
    "lewiston": "LWS",
    "lexington": "LEX",
    "lille": "LIL",
    "lima": "LIM",
    "limaohio": "AOH",
    "lincoln": "LNK",
    "lisbon": "LIS",
    "littlerock": "LIT",
    "liverpool": "LPL",
    "logan": "LGU",
    "loire": "NTE",
    "london": "LHR",
    "londonon": "YXU",
    "longisland": "ISP",
    "losangeles": "LAX",
    "louisville": "SDF",
    "loz": "AIZ",
    "lubbock": "LBB",
    "lucknow": "LKO",
    "luxembourg": "LUX",
    "lynchburg": "LYH",
    "lyon": "LYS",
    "macon": "MCN",
    "madison": "MSN",
    "madrid": "MAD",
    "maine": "PWM",
    "malaga": "AGP",
    "malaysia": "KUL",
    "managua": "MGA",
    "manchester": "MAN",
    "manila": "MNL",
    "mankato": "MKT",
    "mansfield": "MFD",
    "marseilles": "MRS",
    "marshall": "MML",
    "martinsburg": "MRB",
    "masoncity": "MCW",
    "mattoon": "MTO",
    "mazatlan": "MZT",
    "mcallen": "MFE",
    "meadville": "GKJ",
    "medford": "MFR",
    "melbourne": "MEL",
    "memphis": "MEM",
    "mendocino": "UKI",
    "merced": "MCE",
    "meridian": "MEI",
    "mexicocity": "MEX",
    "miami": "MIA",
    "micronesia": "GUM",
    "micronesia": "GUM",
    "milan": "MXP",
    "milwaukee": "MKE",
    "minneapolis": "MSP",
    "missoula": "MSO",
    "mobile": "MOB",
    "modesto": "MOD",
    "mohave": "IFP",
    "monroe": "MLU",
    "monroemi": "TTF",
    "montana": "GDV",
    "monterey": "MRY",
    "monterrey": "MTY",
    "montevideo": "MVD",
    "montgomery": "MGM",
    "montpellier": "MPL",
    "montreal": "YUL",
    "morgantown": "MGW",
    "moscow": "SVO",
    "moseslake": "MWH",
    "mumbai": "BOM",
    "muncie": "MIE",
    "munich": "MUC",
    "muskegon": "MKG",
    "myrtlebeach": "MYR",
    "nacogdoches": "OCH",
    "naga": "WNP",
    "nagoya": "NGO",
    "nanaimo": "YCD",
    "nanjing": "NKG",
    "naples": "NAP",
    "nashville": "BNA",
    "natchez": "HEZ",
    "nd": "MOT",
    "nesd": "ATY",
    "newbrunswick": "YQM",
    "newcastle": "NCL",
    "newfoundland": "YYT",
    "newhaven": "HVN",
    "newjersey": "EWR",
    "newlondon": "GON",
    "neworleans": "MSY",
    "newyork": "JFK",
    "nh": "MHT",
    "niagara": "YCM",
    "nmi": "TVC",
    "norfolk": "ORF",
    "northernwi": "EAU",
    "northmiss": "TUP",
    "northplatte": "LBF",
    "norwich": "NWI",
    "nottingham": "NQT",
    "ntl": "NTL",
    "nuremberg": "NUE",
    "nwct": "DXR",
    "nwga": "RMG",
    "nwks": "GLD",
    "oaxaca": "OAX",
    "ocala": "OCF",
    "odessa": "MAF",
    "ogden": "OGD",
    "okaloosa": "VPS",
    "okinawa": "OKA",
    "oklahomacity": "OKC",
    "olympic": "CLM",
    "omaha": "OMA",
    "oneonta": "ONH",
    "onslow": "OAJ",
    "orangecounty": "SNA",
    "oregoncoast": "ONP",
    "orlando": "MCO",
    "osaka": "KIX",
    "oslo": "OSL",
    "ottawa": "YOW",
    "ottumwa": "OTM",
    "outerbanks": "FFA",
    "owensboro": "OWB",
    "owensound": "YOS",
    "oxford": "OXF",
    "pakistan": "KHI",
    "palmsprings": "PSP",
    "pampanga": "CRK",
    "panama": "PAC",
    "panamacity": "PFN",
    "paris": "CDG",
    "parkersburg": "PKB",
    "peace": "YPE",
    "pei": "YYG",
    "pennstate": "UNV",
    "pensacola": "PNS",
    "peoria": "PIA",
    "perth": "PER",
    "perugia": "PEG",
    "peterborough": "YPQ",
    "philadelphia": "PHL",
    "phoenix": "PHX",
    "pittsburgh": "PIT",
    "plattsburgh": "PBG",
    "poconos": "MPO",
    "porthuron": "PHN",
    "portland": "PDX",
    "porto": "OPO",
    "portoalegre": "POA",
    "potsdam": "MSS",
    "prague": "PRG",
    "prescott": "PRC",
    "pretoria": "PRY",
    "princegeorge": "YXS",
    "providence": "PVD",
    "provo": "PVU",
    "puebla": "PBC",
    "pueblo": "PUB",
    "puertorico": "SJU",
    "puertorico": "SJU",
    "pullman": "PUW",
    "pune": "PNQ",
    "pv": "PVR",
    "quadcities": "MLI",
    "quebec": "YQB",
    "quincy": "UIN",
    "quito": "UIO",
    "racine": "RAC",
    "raleigh": "RDU",
    "ramallah": "JRS",
    "rapidcity": "RAP",
    "reading": "RDG",
    "recife": "REC",
    "reddeer": "YQF",
    "redding": "RDD",
    "regina": "YQR",
    "rennes": "RNS",
    "reno": "RNO",
    "reykjavik": "RKV",
    "richmond": "RIC",
    "richmondin": "RID",
    "rio": "GIG",
    "rmn": "RST",
    "roanoke": "ROA",
    "rochester": "ROC",
    "rockford": "RFD",
    "rockies": "EGE",
    "rome": "FCO",
    "roseburg": "RBG",
    "roswell": "ROW",
    "rouen": "URO",
    "sacramento": "SMF",
    "saginaw": "MBS",
    "saguenay": "YBG",
    "salem": "SLE",
    "salina": "SLN",
    "saltlakecity": "SLC",
    "salvador": "SSA",
    "sanangelo": "SJT",
    "sanantonio": "SAT",
    "sandiego": "SAN",
    "sandusky": "SKY",
    "sanmarcos": "HYI",
    "santabarbara": "SBA",
    "santafe": "SAF",
    "santamaria": "SMX",
    "santiago": "SCL",
    "santodomingo": "SDQ",
    "saopaulo": "GRU",
    "sapporo": "CTS",
    "sarasota": "SRQ",
    "sardinia": "CAG",
    "sarnia": "YZR",
    "saskatoon": "YXE",
    "savannah": "SAV",
    "scottsbluff": "BFF",
    "scranton": "AVP",
    "sd": "PIR",
    "seattle": "SEA",
    "seks": "FSK",
    "semo": "CGI",
    "sendai": "SDJ",
    "seoul": "ICN",
    "sevilla": "SVQ",
    "sfbay": "SFO",
    "shanghai": "SHA",
    "sheboygan": "SBM",
    "sheffield": "DSA",
    "shenyang": "SHE",
    "shenzhen": "SZX",
    "sherbrooke": "YSC",
    "shoals": "MSL",
    "showlow": "SOW",
    "shreveport": "SHV",
    "sicily": "PMO",
    "sierravista": "FHU",
    "singapore": "SIN",
    "siouxcity": "SUX",
    "siouxfalls": "FSD",
    "siskiyou": "SIY",
    "skagit": "BVS",
    "skeena": "YYD",
    "slo": "SBP",
    "smd": "2W6",
    "soo": "YAM",
    "southbend": "SBN",
    "southcoast": "EWB",
    "southjersey": "MIV",
    "spacecoast": "TIX",
    "spokane": "GEG",
    "springfield": "SGF",
    "springfieldil": "SPI",
    "statesboro": "TBR",
    "staugustine": "UST",
    "stcloud": "STC",
    "stgeorge": "SGU",
    "stillwater": "SWO",
    "stjoseph": "STJ",
    "stlouis": "STL",
    "stockholm": "ARN",
    "stockton": "SCK",
    "stpetersburg": "LED",
    "strasbourg": "SXB",
    "stuttgart": "STR",
    "sudbury": "YSB",
    "sunshine": "YHS",
    "surat": "STV",
    "susanville": "SVE",
    "swks": "GCK",
    "swmi": "BEH",
    "swv": "BKW",
    "swva": "MKJ",
    "sydney": "SYD",
    "syracuse": "SYR",
    "taipei": "TPE",
    "tallahassee": "TLH",
    "tampa": "TPA",
    "tehran": "IKA",
    "telaviv": "TLV",
    "terrehaute": "HUF",
    "territories": "YZF",
    "texarkana": "TXK",
    "texoma": "GYI",
    "thumb": "PHN",
    "thunderbay": "YQT",
    "tijuana": "TIJ",
    "tippecanoe": "LAF",
    "tokyo": "NRT",
    "toledo": "TOL",
    "topeka": "FOE",
    "torino": "TRN",
    "toronto": "YYZ",
    "toulouse": "TLS",
    "treasure": "VRB",
    "tricities": "TRI",
    "troisrivieres": "YRQ",
    "tucson": "TUS",
    "tulsa": "TUL",
    "tunis": "TUN",
    "tuscaloosa": "TCL",
    "tuscarawas": "PHD",
    "twinfalls": "TWF",
    "twintiers": "OLE",
    "ukraine": "IEV",
    "up": "MQT",
    "utica": "UCA",
    "valdosta": "VLD",
    "valencia": "VLC",
    "vancouver": "YVR",
    "venice": "VCE",
    "ventura": "OXR",
    "veracruz": "VER",
    "victoria": "YYJ",
    "victoriatx": "VCT",
    "vienna": "VIE",
    "vietnam": "SGN",
    "virgin": "STT",
    "virgin": "STT",
    "visalia": "VIS",
    "waco": "ACT",
    "warsaw": "WAW",
    "washingtondc": "IAD",
    "waterloo": "ALO",
    "watertown": "ART",
    "wausau": "AUW",
    "wellington": "WLG",
    "wenatchee": "EAT",
    "westernmass": "CEF",
    "westky": "PAH",
    "westmd": "CBE",
    "westslope": "GJT",
    "wheeling": "HLG",
    "whistler": "YWS",
    "whitehorse": "YXY",
    "wichita": "ICT",
    "wichitafalls": "SPS",
    "williamsport": "IPT",
    "wilmington": "ILM",
    "winchester": "OKV",
    "windsor": "YQG",
    "winnipeg": "YWG",
    "winstonsalem": "INT",
    "wollongong": "WOL",
    "worcester": "ORH",
    "wuhan": "WUH",
    "wv": "CRW",
    "wyoming": "CPR",
    "xian": "XIY",
    "yakima": "YKM",
    "yellowknife": "YZF",
    "york": "THV",
    "youngstown": "YNG",
    "yubasutter": "MYV",
    "yucatan": "MID",
    "yuma": "YUM",
    "zagreb": "ZAG",
    "zamboanga": "ZAM",
    "zanesville": "ZZV"}

def craigslist_url_to_sitekey(url):
    """http://longisland.craigslist.com/FemaleEscorts/s-mny-oo-chics-but-oo-nn-lik-oo-me-19/40317377"""
    (scheme, netloc, path, params, query, fragment) = urlparse(url)
    sitekey = netloc.split('.')[0]
    return sitekey

def determineMarketCraigslist(url, title, city, state):
    return marketid_to_market_tuple("url", craigslist_sitekey_to_marketid[craigslist_url_to_sitekey(url)])

### CLASSIVOX

classivox_sitekey_to_marketid = {
                                 "abilene": "ABI",
                                 "akron": "CAK",
                                 "albany": "ALB",
                                 "albany-ga": "ABY",
                                 "albuquerque": "ABQ",
                                 "altoona": "AOO",
                                 "amarillo": "AMA",
                                 "ames": "AMW",
                                 "anchorage": "ANC",
                                 "ann-arbor": "ARB",
                                 "annapolis": "ANP",
                                 "appleton": "ATW",
                                 "asheville": "AVL",
                                 "ashtabula": "HZY",
                                 "athens": "AHN",
                                 "athens-oh": "ATO",
                                 "atlanta": "ATL",
                                 "auburn": "AUO",
                                 "augusta": "AGS",
                                 "austin": "AUS",
                                 "bakersfield": "BFL",
                                 "baltimore": "BWI",
                                 "baton-rouge": "BTR",
                                 "battle-creek": "AZO",
                                 "beaumont": "BPT",
                                 "bellingham": "BLI",
                                 "bemidji": "BJI",
                                 "bend": "RDM",
                                 "billings": "BIL",
                                 "binghamton": "BGM",
                                 "birmingham-al": "BHM",
                                 "bismarck": "BIS",
                                 "bloomington": "BMI",
                                 "bloomington-in": "BMG",
                                 "boise": "BOI",
                                 "boone": "NC06",
                                 "boston": "BOS",
                                 "boulder": "WBU",
                                 "bowling-green": "BWG",
                                 "bozeman": "BZN",
                                 "broward-county": "MIA",
                                 "brownsville": "BRO",
                                 "brunswick": "BQK",
                                 "buffalo": "BUF",
                                 "burlington": "BTV",
                                 "calgary": "YYC",
                                 "cape-cod": "PVC",
                                 "catskills": "20N",
                                 "cedar-rapids": "CID",
                                 "central-mi": "LAN",
                                 "central-nj": "47N",
                                 "charleston": "CHS",
                                 "charleston-wv": "CRW",
                                 "charlotte": "CLT",
                                 "charlottesville": "CHO",
                                 "chattanooga": "CHA",
                                 "chautauqua": "JHW",
                                 "chicago": "ORD",
                                 "chico": "CIC",
                                 "chillicothe": "RZT",
                                 "cincinnati": "CVG",
                                 "clarksville": "CKV",
                                 "cleveland": "CLE",
                                 "clovis": "CVN",
                                 "college-station": "CLL",
                                 "colorado-springs": "COS",
                                 "columbia": "COU",
                                 "columbia-sc": "CAE",
                                 "columbus": "CMH",
                                 "columbus-oh": "CMH",
                                 "comox-valley": "YQQ",
                                 "cookeville": "SRB",
                                 "corpus-christi": "CRP",
                                 "corvallis": "CVO",
                                 "cumberland": "CBE",
                                 "dallas-ft-worth": "DFW",
                                 "danville": "DAN",
                                 "dayton": "DAY",
                                 "daytona-beach": "DAB",
                                 "decatur": "DEC",
                                 "del-rio": "DRT",
                                 "delaware": "ILG",
                                 "denver": "DEN",
                                 "des-moines": "DSM",
                                 "detroit": "DTW",
                                 "dothan": "DHN",
                                 "dubuque": "DBQ",
                                 "duluth": "DLH",
                                 "east-oregon": "PDT",
                                 "eastern-co": "LIC",
                                 "eastern-ct": "GON",
                                 "eastern-ky": "PBX",
                                 "eastern-nc": "PGV",
                                 "eastern-panhandle": "MRB",
                                 "eastern-shore": "SBY",
                                 "eau-claire": "EAU",
                                 "edmonton": "YEG",
                                 "el-paso": "ELP",
                                 "elko": "EKO",
                                 "elmira": "ELM",
                                 "erie": "ERI",
                                 "eugene": "EUG",
                                 "evansville": "EVV",
                                 "fairbanks": "FAI",
                                 "fargo": "FAR",
                                 "farmington": "FMN",
                                 "fayetteville": "XNA",
                                 "fayetteville-nc": "FAY",
                                 "flagstaff-sedona": "FLG",
                                 "flint": "FNT",
                                 "florence": "FLO",
                                 "florence-muscle-shoals": "MSL",
                                 "florida-keys": "EYW",
                                 "fort-collins": "FNL",
                                 "fort-dodge": "FOD",
                                 "fort-lauderdale": "FLL",
                                 "fort-smith": "FSM",
                                 "fort-wayne": "FWA",
                                 "frederick": "FDK",
                                 "fredericksburg-va": "EZF",
                                 "fresno-madera": "FAT",
                                 "ft-mcmurray": "YMM",
                                 "gadsden-anniston": "GAD",
                                 "gainesville": "GNV",
                                 "galveston": "GLS",
                                 "glens-falls": "GFL",
                                 "gold-country": "O22",
                                 "grand-forks": "GFK",
                                 "grand-island": "GRI",
                                 "grand-rapids": "GRR",
                                 "green-bay": "GRB",
                                 "greensboro": "GSO",
                                 "greenville": "GSP",
                                 "guelph": "CNC4",
                                 "gulfport": "GPT",
                                 "hamilton-burlington": "YHM",
                                 "hampton-roads": "ORF",
                                 "hanford-corcoran": "HJO",
                                 "harrisburg": "MDT",
                                 "harrisonburg": "SHD",
                                 "hartford": "HFD",
                                 "hattiesburg": "HBG",
                                 "hickory": "HKY",
                                 "high-rockies": "EGE",
                                 "hilton-head": "HHH",
                                 "holland": "BIV",
                                 "honolulu": "HNL",
                                 "houma": "HUM",
                                 "houston": "IAH",
                                 "hudson-valley": "SWF",
                                 "humboldt-county": "ACV",
                                 "huntington": "HTS",
                                 "huntsville-decatur": "HSV",
                                 "imperial-county": "IPL",
                                 "indianapolis": "IND",
                                 "inland-empire": "ONT",
                                 "iowa-city": "IOW",
                                 "ithaca": "ITH",
                                 "jackson": "JAN",
                                 "jackson-tn": "MKL",
                                 "jacksonville": "JAX",
                                 "jacksonville-nc": "OAJ",
                                 "janesville": "JVL",
                                 "jersey-shore": "ACY",
                                 "jonesboro": "JBR",
                                 "joplin": "JLN",
                                 "kalamazoo": "AZO",
                                 "kansas-city": "MCI",
                                 "kenai-peninsula": "ENA",
                                 "kennewick": "PSC",
                                 "kenosha": "RAC",
                                 "killeen": "GRK",
                                 "kirksville": "IRK",
                                 "klamath-falls": "LMT",
                                 "knoxville": "TYS",
                                 "kokomo": "OKK",
                                 "lafayette": "LAF",
                                 "lafayette-la": "LAF",
                                 "lakeland": "LAL",
                                 "lancaster": "LNS",
                                 "lansing": "LAN",
                                 "laredo": "LRD",
                                 "las-cruces": "LRU",
                                 "las-vegas": "LAS",
                                 "lawrence": "LWC",
                                 "lawton": "LAW",
                                 "lehigh-valley": "ABE",
                                 "lethbridge": "YQL",
                                 "lewiston": "LWS",
                                 "lexington": "LEX",
                                 "lima-oh": "AOH",
                                 "lincoln": "LNK",
                                 "little-rock": "LIT",
                                 "logan": "LGU",
                                 "london-on": "YXU",
                                 "long-island": "ISP",
                                 "los-angeles": "LAX",
                                 "louisville": "SDF",
                                 "lubbock": "LBB",
                                 "lynchburg": "LYH",
                                 "macon": "MCN",
                                 "madison": "MSN",
                                 "maine": "PWM",
                                 "manhattan": "JFK",
                                 "mankato": "MKT",
                                 "mansfield": "MFD",
                                 "mason-city": "MCW",
                                 "mattoon": "MTO",
                                 "mcallen": "MFE",
                                 "medford": "MFR",
                                 "medicine-hat": "YXH",
                                 "memphis": "MEM",
                                 "mendocino-county": "UKI",
                                 "merced": "MCE",
                                 "miami-dade": "MIA",
                                 "milwaukee": "MKE",
                                 "minneapolis": "MSP",
                                 "mobile": "MOB",
                                 "modesto": "MOD",
                                 "mohave-county": "IFP",
                                 "monroe": "MLU",
                                 "monroe-mi": "TTF",
                                 "monterey-bay": "MRY",
                                 "montgomery": "MGM",
                                 "montreal": "YUL",
                                 "morgantown": "MGW",
                                 "moses-lake": "MWH",
                                 "muncie": "MIE",
                                 "muskegon": "MKG",
                                 "myrtle-beach": "MYR",
                                 "nanaimo": "YCD",
                                 "nashville": "BNA",
                                 "new-hampshire": "MHT",
                                 "new-haven": "HVN",
                                 "new-orleans": "MSY",
                                 "new-river-valley": "BCB",
                                 "new-york-city": "JFK",
                                 "niagara": "YCM",
                                 "north-dakota": "FAR",
                                 "north-jersey": "EWR",
                                 "north-ms": "TUP",
                                 "north-panhandle": "HLG",
                                 "north-platte": "LBF",
                                 "northern-mi": "TVC",
                                 "northern-wi": "EAU",
                                 "northwest-ct": "DXR",
                                 "northwest-ga": "RMG",
                                 "ocala": "OCF",
                                 "odessa": "MAF",
                                 "ogden": "OGD",
                                 "okaloosa": "VPS",
                                 "oklahoma-city": "OKC",
                                 "old-west-virginia": "CRW",
                                 "omaha": "OMA",
                                 "oneonta": "ONH",
                                 "orange-county": "SNA",
                                 "oregon-coast": "ONP",
                                 "orlando": "MCO",
                                 "outer-banks": "FFA",
                                 "owen-sound": "YOS",
                                 "owensboro": "OWB",
                                 "ozarks": "AIZ",
                                 "palm-beach-county": "PBI",
                                 "palm-springs": "PSP",
                                 "panama-city": "PFN",
                                 "parkersburg": "PKB",
                                 "peace-river-country": "YPE",
                                 "pensacola": "PNS",
                                 "peoria": "PIA",
                                 "philadelphia": "PHL",
                                 "phoenix": "PHX",
                                 "pittsburgh": "PIT",
                                 "plattsburgh": "PBG",
                                 "poconos": "MPO",
                                 "portland": "PDX",
                                 "potsdam": "MSS",
                                 "prescott": "PRC",
                                 "provo": "PVU",
                                 "pueblo": "PUB",
                                 "pullman": "PUW",
                                 "quad-cities": "MLI",
                                 "quebec-city": "YQB",
                                 "queens": "JFK",
                                 "raleigh": "RDU",
                                 "reading": "RDG",
                                 "red-deer": "YQF",
                                 "redding": "RDD",
                                 "regina": "YQR",
                                 "reno": "RNO",
                                 "richmond": "RID",
                                 "roanoke": "ROA",
                                 "rochester": "RST",
                                 "rochester-ny": "ROC",
                                 "rockford": "RFD",
                                 "roseburg": "RBG",
                                 "roswell": "ROW",
                                 "sacramento": "SMF",
                                 "saginaw": "MBS",
                                 "salem": "SLE",
                                 "salina": "SLN",
                                 "salt-lake-city": "SLC",
                                 "san-angelo": "SJT",
                                 "san-antonio": "SAT",
                                 "san-diego": "SAN",
                                 "san-francisco": "SFO",
                                 "san-luis-obispo": "SBP",
                                 "san-marcos": "HYI",
                                 "sandusky": "SKY",
                                 "santa-barbara": "SBA",
                                 "santa-fe": "SAF",
                                 "santa-maria": "SMX",
                                 "sarasota": "SRQ",
                                 "savannah": "SAV",
                                 "scottsbluff": "BFF",
                                 "scranton": "AVP",
                                 "seattle-tacoma": "SEA",
                                 "sheboygan": "SBM",
                                 "show-low": "SOW",
                                 "shreveport": "SHV",
                                 "sierra-vista": "FHU",
                                 "sioux-city": "SUX",
                                 "siskiyou-county": "SIY",
                                 "south-bend": "SBN",
                                 "south-coast": "EWB",
                                 "south-dakota": "PIR",
                                 "south-jersey": "MIV",
                                 "south-wv": "BKW",
                                 "southeast-alaska": "JNU",
                                 "southeast-mo": "CGI",
                                 "southern-il": "MDH",
                                 "southern-md": "2W6",
                                 "southwest-mn": "MML",
                                 "southwest-va": "MKJ",
                                 "space-coast": "TIX",
                                 "spokane": "GEG",
                                 "springfield": "SPI",
                                 "springfield-mo": "SGF",
                                 "st-augustine": "UST",
                                 "st-cloud": "STC",
                                 "st-george": "SGU",
                                 "st-joseph": "STJ",
                                 "st-louis": "STL",
                                 "state-college": "UNV",
                                 "statesboro": "TBR",
                                 "stillwater": "SWO",
                                 "stockton": "SCK",
                                 "susanville": "SVE",
                                 "syracuse": "SYR",
                                 "tallahassee": "TLH",
                                 "tampa-bay": "TPA",
                                 "terre-haute": "HUF",
                                 "texarkana": "TXK",
                                 "texoma": "GYI",
                                 "toledo": "TOL",
                                 "topeka": "FOE",
                                 "toronto": "YYZ",
                                 "treasure-coast": "VRB",
                                 "tri-cities": "TRI",
                                 "tucson": "TUS",
                                 "tulsa": "TUL",
                                 "tuscaloosa": "TCL",
                                 "twin-falls": "TWF",
                                 "tyler": "TYR",
                                 "utica": "UCA",
                                 "valdosta": "VLD",
                                 "ventura-county": "OXR",
                                 "victoria-tx": "VCT",
                                 "visalia-tulare": "VIS",
                                 "waco": "ACT",
                                 "washington-dc": "IAD",
                                 "waterloo": "YKF",
                                 "watertown": "ART",
                                 "wausau": "AUW",
                                 "wenatchee": "EAT",
                                 "west-palm-beach": "PBI",
                                 "western-il": "UIN",
                                 "western-ky": "PAH",
                                 "western-ma": "CEF",
                                 "western-md": "CBE",
                                 "western-slope": "GJT",
                                 "wichita": "ICT",
                                 "wichita-falls": "SPS",
                                 "williamsport": "IPT",
                                 "wilmington": "ILG",
                                 "winchester": "OKV",
                                 "winnipeg": "YWG",
                                 "winston-salem": "INT",
                                 "worcester": "ORH",
                                 "yakima": "YKM",
                                 "york": "THV",
                                 "youngstown": "YNG",
                                 "yuma": "YUM",
                                 "zanesville": "ZZV"}

def classivox_url_to_sitekey(url):
    """http://longisland.classivox.com/FemaleEscorts/s-mny-oo-chics-but-oo-nn-lik-oo-me-19/40317377"""
    (scheme, netloc, path, params, query, fragment) = urlparse(url)
    sitekey = netloc.split('.')[0]
    return sitekey

def determineMarketClassivox(url, title, city, state):
    return marketid_to_market_tuple("url", classivox_sitekey_to_marketid[classivox_url_to_sitekey(url)])

### MYPROVIDERGUIDE

myproviderguide_sitekey_to_marketid = {
                                       "abilene": "ABI",
                                       "akron": "CAK",
                                       "albany": "ALB",
                                       "albuquerque": "ABQ",
                                       "allentown": "ABE",
                                       "altoona": "AOO",
                                       "amarillo": "AMA",
                                       "ames-ia": "AMW",
                                       "amsterdam": "AMS",
                                       "ann-arbor": "ARB",
                                       "annapolis": "ANP",
                                       "appleton": "ATW",
                                       "asheville": "AVL",
                                       "athens-ga": "AHN",
                                       "athens-oh": "ATO",
                                       "atlanta": "ATL",
                                       "auburn": "AUO",
                                       "augusta": "AGS",
                                       "austin": "AUS",
                                       "bakersfield": "BFL",
                                       "baltimore": "BWI",
                                       "barrie": "QEB",
                                       "bath": "BRS",
                                       "baton-rouge": "BTR",
                                       "beaumont": "BPT",
                                       "belfast": "BFS",
                                       "belleville": "YTR",
                                       "bellingham": "BLI",
                                       "bend": "RDM",
                                       "berlin": "TXL",
                                       "biloxi": "GPT",
                                       "binghamton": "BGM",
                                       "birmingham": "BHM",
                                       "birmingham-uk": "BHX",
                                       "bismarck": "BIS",
                                       "blacksburg": "BCB",
                                       "bloomington": "BMG",
                                       "bloomington-normal": "BMI",
                                       "boise": "BOI",
                                       "boone": "NC06",
                                       "boston": "BOS",
                                       "boulder": "WBU",
                                       "bowling-green": "BWG",
                                       "brighton": "ESH",
                                       "bristol": "BRS",
                                       "bronx": "JFK",
                                       "brooklyn": "JFK",
                                       "brunswick-ga": "BQK",
                                       "brussels": "BRU",
                                       "budapest": "BUD",
                                       "buffalo": "BUF",
                                       "calgary": "YYC",
                                       "cambridge": "CBG",
                                       "cape-cod": "PVC",
                                       "carbondale": "MDH",
                                       "cardiff": "CWL",
                                       "catskills": "20N",
                                       "cedar-rapids": "CID",
                                       "central-jersey": "47N",
                                       "champaign": "CMI",
                                       "charleston-sc": "CHS",
                                       "charleston-wv": "CRW",
                                       "charlotte": "CLT",
                                       "charlottesville": "CHO",
                                       "chatham": "XCM",
                                       "chattanooga": "CHA",
                                       "chautauqua": "JHW",
                                       "chicago": "ORD",
                                       "chico": "CIC",
                                       "cincinnati": "CVG",
                                       "clarksville": "CKV",
                                       "cleveland": "CLE",
                                       "colorado-springs": "COS",
                                       "columbia-sc": "CAE",
                                       "columbus": "CMH",
                                       "columbus-ga": "CSG",
                                       "copenhagen": "CPH",
                                       "cornwall": "YCC",
                                       "corpus-christi": "CRP",
                                       "corvallis": "CVO",
                                       "coventry": "CVT",
                                       "cranbrook": "YXC",
                                       "dallas": "DFW",
                                       "danville": "DAN",
                                       "dayton": "DAY",
                                       "daytona-beach": "DAB",
                                       "decatur-il": "DEC",
                                       "delaware": "ILG",
                                       "denton": "DFW",
                                       "denver": "DEN",
                                       "derby": "EMA",
                                       "des-moines": "DSM",
                                       "detroit": "DTW",
                                       "devon": "EXT",
                                       "dothan-al": "DHN",
                                       "dublin": "DUB",
                                       "dubuque": "DBQ",
                                       "duluth": "DLH",
                                       "dundee": "DND",
                                       "eau-claire": "EAU",
                                       "edinburgh": "EDI",
                                       "edmonton": "YEG",
                                       "elmira-corning": "ELM",
                                       "erie-pa": "ERI",
                                       "essex": "STN",
                                       "eugene": "EUG",
                                       "evansville": "EVV",
                                       "fargo": "FAR",
                                       "farmington-nm": "FMN",
                                       "fayetteville": "FAY",
                                       "fayetteville-ar": "XNA",
                                       "flagstaff": "FLG",
                                       "flint": "FNT",
                                       "florence": "FLO",
                                       "florence-sc": "FLO",
                                       "florida-keys": "EYW",
                                       "fort-collins": "FNL",
                                       "fort-lauderdale": "FLL",
                                       "fort-myers": "RSW",
                                       "fort-smith-ar": "FSM",
                                       "fort-wayne": "FWA",
                                       "fort-worth": "DFW",
                                       "fredericksburg": "EZF",
                                       "fresno": "FAT",
                                       "gadsden-anniston": "GAD",
                                       "gainesville": "GNV",
                                       "galveston": "GLS",
                                       "glasgow": "GLA",
                                       "gold-country": "O22",
                                       "grand-island": "GRI",
                                       "grand-rapids": "GRR",
                                       "green-bay": "GRB",
                                       "greensboro": "GSO",
                                       "greenville": "GSP",
                                       "guelph": "CNC4",
                                       "halifax": "YHZ",
                                       "hamilton": "YHM",
                                       "hampshire": "SOU",
                                       "hampton": "ORF",
                                       "harrisburg": "MDT",
                                       "harrisonburg": "SHD",
                                       "hartford": "HFD",
                                       "hattiesburg": "HBG",
                                       "hickory": "HKY",
                                       "hilton-head": "HHH",
                                       "honolulu": "HNL",
                                       "houston": "IAH",
                                       "hudson-valley": "SWF",
                                       "humboldt-county": "ACV",
                                       "huntington-ashland": "HTS",
                                       "huntsville": "HSV",
                                       "imperial-county": "IPL",
                                       "indianapolis": "IND",
                                       "inland-empire": "ONT",
                                       "iowa-city": "IOW",
                                       "ithaca": "ITH",
                                       "jackson-mi": "JXN",
                                       "jackson-ms": "JAN",
                                       "jackson-tn": "MKL",
                                       "jacksonville": "JAX",
                                       "janesville": "JVL",
                                       "jersey-shore": "ACY",
                                       "jonesboro": "JBR",
                                       "joplin": "JLN",
                                       "kalamazoo": "AZO",
                                       "kamloops": "YKA",
                                       "kansas-city": "MCI",
                                       "kelowna": "YLW",
                                       "kennewick-pasco-richland": "PSC",
                                       "kenosha-racine": "RAC",
                                       "kent": "LYX",
                                       "killeen": "GRK",
                                       "kingston": "YGK",
                                       "kitchener": "YKF",
                                       "knoxville": "TYS",
                                       "la-crosse": "LSE",
                                       "lafayette": "LFT",
                                       "lake-charles": "LCH",
                                       "lakeland": "LAL",
                                       "lancaster-pa": "LNS",
                                       "lansing": "LAN",
                                       "laredo": "LRD",
                                       "las-vegas": "LAS",
                                       "lawrence": "LWC",
                                       "lawton": "LAW",
                                       "leeds": "LBA",
                                       "lehigh-valley": "ABE",
                                       "lethbridge": "YQL",
                                       "lexington-ky": "LEX",
                                       "lima": "AOH",
                                       "lincoln": "LNK",
                                       "little-rock": "LIT",
                                       "liverpool": "LPL",
                                       "logan": "LGU",
                                       "london": "LHR",
                                       "london-canada": "YXU",
                                       "long-island": "ISP",
                                       "los-angeles": "LAX",
                                       "louisville": "SDF",
                                       "lubbock": "LBB",
                                       "lynchburg": "LYH",
                                       "macon": "MCN",
                                       "madison": "MSN",
                                       "maine": "PWM",
                                       "manchester": "MAN",
                                       "manhattan-ks": "MHK",
                                       "mankato": "MKT",
                                       "mansfield": "MFD",
                                       "martinsburg": "MRB",
                                       "medford-ashland-klamath": "MFR",
                                       "memphis": "MEM",
                                       "mendocino-county": "UKI",
                                       "merced": "MCE",
                                       "miami": "MIA",
                                       "milwaukee": "MKE",
                                       "minneapolis": "MSP",
                                       "minot": "MOT",
                                       "mobile": "MOB",
                                       "modesto": "MOD",
                                       "mohave-county": "IFP",
                                       "monroe-la": "MLU",
                                       "montana": "HLN",
                                       "monterey-bay": "MRY",
                                       "montgomery": "MGM",
                                       "montreal": "YUL",
                                       "morgantown": "MGW",
                                       "mumbai": "BOM",
                                       "muncie": "MIE",
                                       "munich": "MUC",
                                       "muskegon": "MKG",
                                       "myrtle-beach": "MYR",
                                       "nanaimo": "YCD",
                                       "nashville": "BNA",
                                       "new-brunswick": "YQM",
                                       "new-delhi": "DEL",
                                       "new-hampshire": "MHT",
                                       "new-haven": "HVN",
                                       "new-orleans": "MSY",
                                       "new-york": "JFK",
                                       "newcastle": "NCL",
                                       "newfoundland": "YYT",
                                       "niagara": "YCM",
                                       "norfolk": "ORF",
                                       "north-dakota": "FAR",
                                       "north-jersey": "EWR",
                                       "norwich": "NWI",
                                       "nottingham": "NQT",
                                       "oakland": "OAK",
                                       "ocala": "OCF",
                                       "odessa": "MAF",
                                       "ogden-clearfield": "OGD",
                                       "oklahoma-city": "OKC",
                                       "omaha": "OMA",
                                       "orange-county": "SNA",
                                       "orlando": "MCO",
                                       "oslo": "OSL",
                                       "ottawa": "YOW",
                                       "outer-banks": "FFA",
                                       "owen-sound": "YOS",
                                       "oxford": "OXF",
                                       "palm-springs-ca": "PSP",
                                       "panama-city-fl": "PFN",
                                       "paris": "CDG",
                                       "parkersburg-marietta": "PKB",
                                       "pensacola": "PNS",
                                       "peoria": "PIA",
                                       "peterborough": "YPQ",
                                       "philadelphia": "PHL",
                                       "phoenix": "PHX",
                                       "pittsburgh": "PIT",
                                       "plattsburgh-adirondacks": "PBG",
                                       "poconos": "MPO",
                                       "port-huron": "PHN",
                                       "portland": "PDX",
                                       "prescott": "PRC",
                                       "prince-george": "YXS",
                                       "providence": "PVD",
                                       "provo": "PVU",
                                       "pueblo": "PUB",
                                       "pullman": "PUW",
                                       "quebec": "YQB",
                                       "queens": "JFK",
                                       "raleigh": "RDU",
                                       "reading": "RDG",
                                       "red-deer": "YQF",
                                       "redding": "RDD",
                                       "regina": "YQR",
                                       "reno": "RNO",
                                       "richmond": "RIC",
                                       "roanoke": "ROA",
                                       "rochester-mn": "RST",
                                       "rochester-ny": "ROC",
                                       "rockford": "RFD",
                                       "rocky-mountains": "EGE",
                                       "roseburg": "RBG",
                                       "roswell": "ROW",
                                       "sacramento": "SMF",
                                       "saginaw-midland-baycity": "MBS",
                                       "saguenay": "YBG",
                                       "saint-louis": "STL",
                                       "salem-or": "SLE",
                                       "salt-lake-city": "SLC",
                                       "san-antonio": "SAT",
                                       "san-diego": "SAN",
                                       "san-fernando-valley": "BUR",
                                       "san-francisco": "SFO",
                                       "san-jose": "SJC",
                                       "san-luis-obispo": "SBP",
                                       "san-marcos": "HYI",
                                       "sandusky": "SKY",
                                       "santa-barbara": "SBA",
                                       "santa-fe": "SAF",
                                       "sarasota-bradenton": "SRQ",
                                       "sarnia": "YZR",
                                       "saskatchewan": "YXE",
                                       "savannah": "SAV",
                                       "scranton": "AVP",
                                       "seattle": "SEA",
                                       "sheboygan-wi": "SBM",
                                       "sheffield": "DSA",
                                       "sherbrooke": "YSC",
                                       "shreveport": "SHV",
                                       "sierra-vista": "FHU",
                                       "sioux-city-ia": "SUX",
                                       "skagit": "BVS",
                                       "south-bend": "SBN",
                                       "south-dakota": "PIR",
                                       "south-jersey": "MIV",
                                       "space-coast": "TIX",
                                       "spokane": "GEG",
                                       "springfield-il": "SPI",
                                       "springfield-ma": "CEF",
                                       "springfield-mo": "SGF",
                                       "st-augustine": "UST",
                                       "st-cloud": "STC",
                                       "st-george": "SGU",
                                       "stillwater": "SWO",
                                       "stockton": "SCK",
                                       "sudbury": "YSB",
                                       "syracuse": "SYR",
                                       "tallahassee": "TLH",
                                       "tampa": "TPA",
                                       "terre-haute": "HUF",
                                       "territories": "YZF",
                                       "texarkana": "TXK",
                                       "thunder-bay": "YQT",
                                       "toledo": "TOL",
                                       "topeka": "FOE",
                                       "toronto": "YYZ",
                                       "treasure-coast": "VRB",
                                       "tucson": "TUS",
                                       "tulsa": "TUL",
                                       "tuscaloosa": "TCL",
                                       "twin-falls": "TWF",
                                       "tyler": "TYR",
                                       "utica": "UCA",
                                       "valdosta": "VLD",
                                       "vancouver": "YVR",
                                       "ventura-county": "OXR",
                                       "vermont": "BTV",
                                       "victoria": "YYJ",
                                       "victoria-tx": "VCT",
                                       "virginia-beach": "ORF",
                                       "visalia-tulare": "VIS",
                                       "waco": "ACT",
                                       "washington-dc": "IAD",
                                       "waterloo": "ALO",
                                       "watertown": "ART",
                                       "wausau": "AUW",
                                       "wenatchee": "EAT",
                                       "west-palm-beach": "PBI",
                                       "wheeling-wv": "HLG",
                                       "whistler": "YWS",
                                       "wichita": "ICT",
                                       "wichita-falls": "SPS",
                                       "williamsport": "IPT",
                                       "wilmington-nc": "ILM",
                                       "windsor": "YQG",
                                       "winnipeg": "YWG",
                                       "winston-salem": "INT",
                                       "worcester": "ORH",
                                       "wyoming": "CPR",
                                       "yakima": "YKM",
                                       "york-pa": "THV",
                                       "youngstown": "YNG",
                                       "yuba-sutter": "MYV",
                                       "yuma": "YUM"}

def myproviderguide_url_to_sitekey(url):
    """http://longisland.myproviderguide.com/FemaleEscorts/s-mny-oo-chics-but-oo-nn-lik-oo-me-19/40317377"""
    (scheme, netloc, path, params, query, fragment) = urlparse(url)
    dirs = path.split('/')
    return dirs[2]

def determineMarketMyproviderguide(url, title, city, state):
    return marketid_to_market_tuple("url", myproviderguide_sitekey_to_marketid[myproviderguide_url_to_sitekey(url)])

### NAUGHTYREVIEWS

naughtyreviews_sitekey_to_marketid = {
                                      ("london",): "LHR",
                                      # springfield	ambiguous
                                      ("toronto",): "YYZ",
                                      ("detroit",): "DTW",
                                      ("atlanta",): "ATL",
                                      ("phoenix",): "PHX",
                                      ("dallas",): "DFW",
                                      # columbus	ambiguous
                                      ("portland",): "PDX",
                                      ("vancouver",): "YVR",
                                      ("miami",): "MIA",
                                      ("boston",): "BOS",
                                      # birmingham	ambiguous
                                      ("denver",): "DEN",
                                      # columbia	ambiguous
                                      ("houston",): "IAH",
                                      ("tampa",): "TPA",
                                      # manchester	ambiguous
                                      ("cleveland",): "CLE",
                                      # charleston	ambiguous
                                      # wilmington	ambiguous
                                      ("orlando",): "MCO",
                                      ("minneapolis",): "MSP",
                                      ("chicago",): "ORD",
                                      ("indianapolis",): "IND",
                                      # rochester	ambiguous
                                      ("pittsburgh",): "PIT",
                                      ("sacramento",): "SMF",
                                      ("cincinnati",): "CVG",
                                      ("paris",): "CDG",
                                      # lafayette	ambiguous
                                      ("nashville",): "BNA",
                                      ("baltimore",): "BWI",
                                      ("louisville",): "SDF",
                                      ("austin",): "AUS",
                                      # fayetteville	ambiguous
                                      ("cambridge",): "CBG",
                                      ("philadelphia",): "PHL",
                                      ("seattle",): "SEA",
                                      ("montreal",): "YUL",
                                      ("jackson",): "JAN",
                                      ("ottawa",): "YOW",
                                      ("charlotte",): "CLT",
                                      ("leicester",): "EMA",
                                      # bloomington	ambiguous
                                      ("southampton",): "SOU",
                                      ("milwaukee",): "MKE",
                                      ("jacksonville",): "JAX",
                                      ("calgary",): "YYC",
                                      ("tulsa",): "TUL",
                                      ("wichita",): "ICT",
                                      ("hamilton",): "YHM",
                                      ("eugene",): "EUG",
                                      ("albuquerque",): "ABQ",
                                      ("greensboro",): "GSO",
                                      ("amsterdam",): "AMS",
                                      ("memphis",): "MEM",
                                      ("leeds",): "LBA",
                                      ("albany",): "ALB",
                                      ("berlin",): "TXL",
                                      ("edmonton",): "YEG",
                                      ("bogota",): "BOG",
                                      ("raleigh",): "RDU",
                                      ("toledo",): "TOL",
                                      ("dusseldorf",): "DUS",
                                      ("kitchener",): "YKF",
                                      ("kiev",): "IEV",
                                      ("akron",): "CAK",
                                      ("asheville",): "AVL",
                                      ("fargo",): "FAR",
                                      ("biloxi",): "GPT",
                                      ("omaha",): "OMA",
                                      ("buffalo",): "BUF",
                                      ("brussels",): "BRU",
                                      ("medford",): "MFR",
                                      ("vienna",): "VIE",
                                      ("madison",): "MSN",
                                      ("milan",): "MXP",
                                      ("minot",): "MOT",
                                      ("dublin",): "DUB",
                                      ("greenville",): "GSP",
                                      ("lexington",): "LEX",
                                      ("sarasota",): "SRQ",
                                      ("madrid",): "MAD",
                                      ("bend",): "RDM",
                                      ("tokyo",): "NRT",
                                      ("hartford",): "HFD",
                                      ("reno",): "RNO",
                                      ("tallahassee",): "TLH",
                                      ("dayton",): "DAY",
                                      ("fredericksburg",): "EZF",
                                      ("caracas",): "CCS",
                                      ("knoxville",): "TYS",
                                      ("munich",): "MUC",
                                      ("bucharest",): "OTP",
                                      ("lisbon",): "LIS",
                                      ("warsaw",): "WAW",
                                      ("providence",): "PVD",
                                      ("brighton",): "ESH",
                                      ("lyon",): "LYS",
                                      ("savannah",): "SAV",
                                      ("chattanooga",): "CHA",
                                      ("tucson",): "TUS",
                                      ("barrie",): "QEB",
                                      ("halifax",): "YHZ",
                                      ("delhi",): "DEL",
                                      ("prague",): "PRG",
                                      ("shreveport",): "SHV",
                                      ("sydney",): "SYD",
                                      ("macon",): "MCN",
                                      ("brisbane",): "BNE",
                                      ("perth",): "PER",
                                      ("helsinki",): "HEL",
                                      ("zurich",): "ZRH",
                                      ("melbourne",): "MEL",
                                      ("amarillo",): "AMA",
                                      ("florence",): "FLO",
                                      ("pensacola",): "PNS",
                                      ("palmdale",): "PMD",
                                      ("missoula",): "MSO",
                                      ("sofia",): "SOF",
                                      ("stockholm",): "ARN",
                                      ("hampton",): "ORF",
                                      ("barcelona",): "BCN",
                                      ("moscow",): "SVO",
                                      ("naples",): "NAP",
                                      ("belfast",): "BFS",
                                      ("porto",): "OPO",
                                      ("richmond",): "RIC",
                                      ("dubai",): "DXB",
                                      ("newark",): "EWR",
                                      ("rome",): "FCO",
                                      ("worcester",): "ORH",
                                      ("frederick",): "FDK",
                                      ("newcastle",): "NCL",
                                      ("edinburgh",): "EDI",
                                      ("kolkata",): "CCU",
                                      ("bahia",): "SSA",
                                      ("hamburg",): "HAM",
                                      ("harrisburg",): "MDT",
                                      ("huntsville",): "HSV",
                                      ("burlington",): "BTV",
                                      ("istanbul",): "IST",
                                      ("nice",): "NCE",
                                      ("martinsburg",): "MRB",
                                      ("marseille",): "MRS",
                                      ("kelowna",): "YLW",
                                      ("gainesville",): "GNV",
                                      ("budapest",): "BUD",
                                      ("johannesburg",): "JNB",
                                      ("bristol",): "BRS",
                                      ("yuma",): "YUM",
                                      ("copenhagen",): "CPH",
                                      ("bangkok",): "BKK",
                                      ("quito",): "UIO",
                                      ("bellingham",): "BLI",
                                      ("shanghai",): "SHA",
                                      ("glasgow",): "GLA",
                                      ("lincoln",): "LNK",
                                      ("auckland",): "AKL",
                                      ("tijuana",): "TIJ",
                                      ("victoria",): "YYJ",
                                      ("arlington",): "IAD",
                                      ("oslo",): "OSL",
                                      ("youngstown",): "YNG",
                                      ("manila",): "MNL",
                                      ("windsor",): "YQG",
                                      ("roanoke",): "ROA",
                                      ("lima",): "LIM",
                                      ("flagstaff",): "FLG",
                                      ("santiago",): "SCL",
                                      ("chelmsford",): "STN",
                                      ("medellin",): "MDE",
                                      ("coventry",): "CVT",
                                      ("norfolk",): "ORF",
                                      ("rotterdam",): "RTM",
                                      ("chico",): "CIC",
                                      ("annapolis",): "ANP",
                                      ("honolulu",): "HNL",
                                      ("allentown",): "ABE",
                                      ("evansville",): "EVV",
                                      ("clarksville",): "CKV",
                                      ("morgantown",): "MGW",
                                      ("montgomery",): "MGM",
                                      ("winnipeg",): "YWG",
                                      ("frankfurt",): "FRA",
                                      ("joplin",): "JLN",
                                      ("bangalore",): "BLR",
                                      ("duluth",): "DLH",
                                      ("maracaibo",): "MAR",
                                      ("poughkeepsie",): "SWF",
                                      ("syracuse",): "SYR",
                                      ("beijing",): "PEK",
                                      ("modesto",): "MOD",
                                      ("cali",): "CLO",
                                      ("cancun",): "CUN",
                                      ("christchurch",): "CHC",
                                      ("sheffield",): "DSA",
                                      ("kingston",): "YGK",
                                      ("boise",): "BOI",
                                      ("mumbai",): "BOM",
                                      ("trenton",): "47N",
                                      ("kalamazoo",): "AZO",
                                      ("wellington",): "WLG",
                                      ("bismarck",): "BIS",
                                      ("concord",): "MHT",
                                      ("norwich",): "NWI",
                                      ("brazilia",): "BSB",
                                      ("liverpool",): "LPL",
                                      ("osaka",): "KIX",
                                      ("scranton",): "AVP",
                                      ("anchorage",): "ANC",
                                      ("singapore",): "SIN",
                                      ("hagerstown",): "HGR",
                                      ("topeka",): "FOE",
                                      ("oakland",): "OAK",
                                      ("strasbourg",): "SXB",
                                      ("davenport",): "MLI",
                                      ("cordoba",): "COR",
                                      ("saginaw",): "MBS",
                                      ("richland",): "PSC",
                                      ("bangor",): "PWM",
                                      ("guangzhou",): "CAN",
                                      ("mendoza",): "MDZ",
                                      ("bakersfield",): "BFL",
                                      ("waco",): "ACT",
                                      ("hyderabad",): "HYD",
                                      ("jakarta",): "CGK",
                                      ("moncton",): "YQM",
                                      ("asuncion",): "ASU",
                                      ("erie",): "ERI",
                                      ("fresno",): "FAT",
                                      ("augusta",): "AGS",
                                      ("spokane",): "GEG",
                                      ("lubbock",): "LBB",
                                      ("lansing",): "LAN",
                                      ("racine",): "RAC",
                                      ("bridgeport",): "BDR",
                                      ("seoul",): "ICN",
                                      ("butte",): "BTM",
                                      # fayettville	ambiguous
                                      ("tacoma",): "TCM",
                                      ("mobile",): "MOB",
                                      ("odessa",): "MAF",
                                      ("hattiesburg",): "HBG",
                                      ("casper",): "CPR",
                                      ("binghamton",): "BGM",
                                      ("champaign",): "CMI",
                                      ("billings",): "BIL",
                                      ("maui",): "OGG",
                                      ("boulder",): "WBU",
                                      ("flint",): "FNT",
                                      ("peoria",): "PIA",
                                      ("spartanburg",): "GSP",
                                      ("rockford",): "RFD",
                                      ("tuscaloosa",): "TCL",
                                      ("helena",): "HLN",
                                      ("stockton",): "SCK",
                                      ("kamloops",): "YKA",
                                      ("reading",): "RDG",
                                      ("monterey",): "MRY",
                                      ("stamford",): "HPN",
                                      ("regina",): "YQR",
                                      ("saskatoon",): "YXE",
                                      ("hammond",): "ORD",
                                      ("kokomo",): "OKK",
                                      ("bismark",): "BIS",
                                      ("frankurt",): "FRA",
                                      ("washington",): "IAD",
                                      ("charlottetown",): "YYG",
                                      ("hagatna",): "GUM",
                                      ("barre",): "BTV",
                                      ("roma",): "RMG",
                                      ("Leicester",): "EMA",
                                      ("nottingham",): "NQT",
                                      ("pittsburg",): "PIT",
                                      ("hollywood",): "BUR",
                                      ("santafe",): "SAF",
                                      # 2-WORD city names
                                      ("las", "vegas",): "LAS",
                                      ("los", "angeles",): "LAX",
                                      ("new", "york",): "JFK",
                                      ("san", "diego",): "SAN",
                                      ("palm", "beach",): "PBI",
                                      ("new", "orleans",): "MSY",
                                      ("st", "louis",): "STL",
                                      ("kansas", "city",): "MCI",
                                      ("washington", "dc",): "MWH",
                                      ("san", "jose",): "SJC",
                                      ("san", "francisco",): "SFO",
                                      ("panama", "city",): "PFN",
                                      ("orange", "county",): "SNA",
                                      ("san", "antonio",): "SAT",
                                      ("fort", "lauderdale",): "FLL",
                                      ("oklahoma", "city",): "OKC",
                                      ("central", "jersey",): "47N",
                                      ("grand", "rapids",): "GRR",
                                      ("myrtle", "beach",): "MYR",
                                      ("lake", "city",): "LCQ",
                                      ("des", "moines",): "DSM",
                                      ("daytona", "beach",): "DAB",
                                      ("baton", "rouge",): "BTR",
                                      ("south", "bend",): "SBN",
                                      ("green", "bay",): "GRB",
                                      ("kuala", "lumpur",): "KUL",
                                      ("fort", "myers",): "RSW",
                                      ("colorado", "springs",): "COS",
                                      ("long", "island",): "ISP",
                                      ("san", "juan",): "SJU",
                                      ("niagara", "falls",): "YCM",
                                      ("virginia", "beach",): "ORF",
                                      ("sioux", "falls",): "FSD",
                                      ("saint", "petersburg",): "LED",
                                      ("red", "deer",): "YQF",
                                      ("st", "cloud",): "STC",
                                      ("sao", "paulo",): "GRU",
                                      ("charlotte", "amalie",): "STT",
                                      ("little", "rock",): "LIT",
                                      ("ft", "mcmurray",): "YMM",
                                      ("new", "haven",): "HVN",
                                      ("buenos", "aires",): "EZE",
                                      ("mexico", "city",): "MEX",
                                      ("atlantic", "city",): "ACY",
                                      ("cape", "town",): "CPT",
                                      ("fort", "wayne",): "FWA",
                                      ("el", "paso",): "ELP",
                                      ("hilton", "head",): "HHH",
                                      ("inland", "empire",): "ONT",
                                      ("key", "west",): "EYW",
                                      ("lake", "charles",): "LCH",
                                      ("jersey", "city",): "EWR",
                                      ("hong", "kong",): "HKG",
                                      ("fort", "collins",): "FNL",
                                      ("santa", "barbara",): "SBA",
                                      ("corpus", "christi",): "CRP",
                                      ("la", "crosse",): "LSE",
                                      ("boca", "raton",): "FLL",
                                      ("northern", "virginia",): "IAD",
                                      ("rapid", "city",): "RAP",
                                      ("ann", "arbor",): "ARB",
                                      ("palm", "springs",): "PSP",
                                      ("taipei", "city",): "TPE",
                                      ("cedar", "rapids",): "CID",
                                      ("tel", "aviv",): "TLV",
                                      ("sioux", "city",): "SUX",
                                      ("great", "falls",): "GTF",
                                      ("long", "beach",): "LGB",
                                      ("terre", "haute",): "HUF",
                                      ("ventura", "county",): "OXR",
                                      ("fort", "smith",): "FSM",
                                      ("traverse", "city",): "TVC",
                                      ("st", "john",): "YQM",
                                      ("bowling", "green",): "BWG",
                                      ("santa", "fe",): "SAF",
                                      ("junction", "city",): "MHK",
                                      # 3-WORD city names
                                      ("san", "fernando", "valley",): "BUR",
                                      ("salt", "lake", "city",): "SLC",
                                      ("salvador", "de", "bahia",): "SSA",
                                      ("rio", "de", "janeiro",): "GIG",
                                      ("west", "palm", "beach",): "PBI",
                                      ("st", "john", "s",): "YYT",
                                      ("ho", "chi", "minh",): "SGN",
                                      ("san", "gabriel", "valley",): "EMT",
                                      ("rio", "grande", "valley",): "BRO"
                                      }

def process(url):
    bits = url.split('/')
    service = bits[3]
    if service in ["escorts", "companions"]:
        line = bits[-1]
        return processEscort(line)
    elif service in ["escort-agencies"]:
        line = bits[-1]
        return processAgency(line)
    elif service in ["na"]:
        print "N",
        line = bits[-1]
        return processEscort(line)
    elif service in ["massage-parlors"]:
        line = bits[-1]
        return processMassage(line)
    else:
        print "Didn't recognize service type %s" % service
        return 0

def lookupSitekey(terms):
    sk3 = naughtyreviews_sitekey_to_marketid.get(tuple(terms[-3:]))
    if sk3:
        return sk3
    sk2 = naughtyreviews_sitekey_to_marketid.get(tuple(terms[-2:]))
    if sk2:
        return sk2
    sk1 = naughtyreviews_sitekey_to_marketid.get(tuple(terms[-1:]))
    if sk1:
        return sk1
    return None

def isGenderMarker(t):
    return t in ["female", "woman", "male", "shemale", "tstvtg", "man", "couple", "female1"]

def isRaceEthnicMarker(t):
    return t in ["white", "black", "asian", "latin", "latino", "latina", "hispanic", "indian", "other", "european", "oriental", "russian", "mixed",""]

def isCompoundRaceEthnicMarker(t):
    return t in [["middle","eastern"]]

def trimNumericSuffix(terms):
    suffix = None
    try:
        i = int(terms[-1])
        suffix = terms[-1]
        terms.pop()
    except ValueError as e:
        pass
    return (suffix, terms)

def trimGenderMarker(terms):
    marker = None
    try:
        if isGenderMarker(terms[-1]):
            marker = terms[-1]
            terms.pop()
    except ValueError as e:
        pass
    return (marker, terms)
    
def trimRaceEthnicMarker(terms):
    marker = None
    try:
        if isCompoundRaceEthnicMarker(terms[-2:]):
            marker = "-".join(terms[-2:])
            terms.pop()
            terms.pop()
        elif isRaceEthnicMarker(terms[-1]):
            marker = terms[-1]
            terms.pop()
    except ValueError as e:
        pass
    return (marker, terms)

def processEscort(line):
    cands = 0
    try:
        terms = line.split('-')[1:]
        (suffix, terms) = trimNumericSuffix(terms)
        (gender, terms) = trimGenderMarker(terms)
        (raceEthnic, terms) = trimRaceEthnicMarker(terms)
        cands = lookupSitekey(terms[-3:])
    except Exception as e:
        print >> sys.stderr, "Give up on escort %r: [%s]" % (line, e)
        return 0
    return cands

def processAgency(line):
    cands = 0
    try:
        terms = line.split('-')[1:]
        (suffix, terms) = trimNumericSuffix(terms)
        cands = lookupSitekey(terms[-3:])
    except Exception as e:
        print >> sys.stderr, "Give up on agency %r: [%s]" % (line, e)
        return 0
    return cands

def processMassage(line):
    terms = line.split('-')[1:]
    return lookupSitekey(terms[-3:])

def naughtyreviews_url_to_marketid(url):
    """http://longisland.naughtyreviews.com/FemaleEscorts/s-mny-oo-chics-but-oo-nn-lik-oo-me-19/40317377"""
    try:
        return process(url)
    except Exception as e:
        print >> sys.stderr, e
        return None

def determineMarketNaughtyreviews(url, title, city, state):
    marketid = naughtyreviews_url_to_marketid(url)
    if marketid:
        return marketid_to_market_tuple("url", marketid)
    else:
        return None

### Redbook

def determineMarketRedbook(url, title, city, state):
    pass

### CITYVIBE

cityvibe_sitekey_to_marketid = {
                                "auburn": "AUO",
                                "birmingham": "BHM",
                                "gadsden": "GAD",
                                "huntsville": "HSV",
                                "montgomery": "MGM",
                                "mobile": "MOB",
                                "anchorage": "ANC",
                                "phoenix": "PHX",
                                "flagstaff": "FLG",
                                "mohavecounty": "IFP",
                                "scottsdale": "PHX",
                                "tucson": "TUS",
                                "yuma": "YUM",
                                "fayettevillear": "XNA",
                                "fortsmith": "FSM",
                                "littlerock": "LIT",
                                "losangeles": "LAX",
                                "sangabrielvalley": "EMT",
                                "orangecounty": "SNA",
                                "sanfrancisco": "SFO",
                                "inlandempire": "ONT",
                                "bakersfield": "BFL",
                                "sanmateo": "SQL",
                                "santacruz": "WVI",
                                "sandiego": "SAN",
                                "santabarbara": "SBA",
                                "sanfernandovalley": "BUR",
                                "ventura": "OXR",
                                "santaclara": "SJC",
                                "sacramento": "SMF",
                                "chico": "CIC",
                                "fresno": "FAT",
                                "northbayca": "STS",
                                "mendocinocounty": "UKI",
                                "humboldtcounty": "ACV",
                                "imperialcounty": "IPL",
                                "palmdale": "PMD",
                                "longbeach": "LGB",
                                "lasvegas": "LAS",
                                "modesto": "MOD",
                                "monterey": "MRY",
                                "sanjose": "SJC",
                                "santamaria": "SMX",
                                "napa": "STS",
                                "oakland": "OAK",
                                "palmsprings": "PSP",
                                "sanluisobispo": "SBP",
                                "santarosa": "STS",
                                "southlaketahoe": "RNO",
                                "tahoe": "RNO",
                                "visalia": "VIS",
                                "denver": "DEN",
                                "boulder": "WBU",
                                "rockies": "EGE",
                                "coloradosprings": "COS",
                                "fortcollins": "FNL",
                                "westernslope": "GJT",
                                "pueblo": "PUB",
                                "hartford": "HFD",
                                "newhaven": "HVN",
                                "easternconnecticut": "GON",
                                "northwestconnecticut": "DXR",
                                "washington": "IAD",
                                "dover": "ILG",
                                "newarkde": "ILG",
                                "wilmingtonde": "ILG",
                                "orlando": "MCO",
                                "fortlauderdale": "FLL",
                                "tampa": "TPA",
                                "spacecoast": "TIX",
                                "miami": "MIA",
                                "ocala": "OCF",
                                "daytonabeach": "DAB",
                                "pensacola": "PNS",
                                "fortmyers": "RSW",
                                "gainesville": "GNV",
                                "jacksonville": "JAX",
                                "westpalmbeach": "PBI",
                                "lakeland": "LAL",
                                "panamacity": "PFN",
                                "sarasota": "SRQ",
                                "staugustine": "UST",
                                "stpetersburg": "TPA",
                                "tallahassee": "TLH",
                                "albanyga": "ABY",
                                "treasurecoast": "VRB",
                                "atlanta": "ATL",
                                "athens": "ATH",
                                "augusta": "AGS",
                                "savannah": "SAV",
                                "columbusga": "CSG",
                                "northwestgeorgia": "RMG",
                                "statesboro": "TBR",
                                "hawaii": "KOA",
                                "honolulu": "HNL",
                                "maui": "OGG",
                                "boise": "BOI",
                                "chicago": "ORD",
                                "rockford": "RFD",
                                "bloomington": "BMI",
                                "chambana": "CMI",
                                "mattoon": "MTO",
                                "decaturil": "DEC",
                                "dixonil": "RFD",
                                "lasallecounty": "VYS",
                                "peoria": "PIA",
                                "naperville": "ORD",
                                "springfieldil": "SPI",
                                "eastchicago": "ORD",
                                "fortwayne": "FWA",
                                "indianapolis": "IND",
                                "lafayette": "LAF",
                                "merrillville": "ORD",
                                "newalbany": "SDF",
                                "southbend": "SBN",
                                "terrehaute": "HUF",
                                "desmoines": "DSM",
                                "cedarrapids": "CID",
                                "councilbluffs": "OMA",
                                "davenport": "MLI",
                                "iowacity": "IOW",
                                "dubuqueia": "DBQ",
                                "siouxcity": "SUX",
                                "waterloo": "ALO",
                                "lawrence": "LWC",
                                "manhattanks": "MHK",
                                "shawnee": "MCI",
                                "topeka": "FOE",
                                "wichita": "ICT",
                                "lexington": "LEX",
                                "louisville": "SDF",
                                "owensboro": "OWB",
                                "shepherdsville": "SDF",
                                "alexandriala": "ESF",
                                "batonrouge": "BTR",
                                "lafayettela": "LFT",
                                "lakecharles": "LCH",
                                "neworleans": "MSY",
                                "shreveport": "SHV",
                                "maine": "PWM",
                                "portlandme": "PDX",
                                "baltimore": "BWI",
                                "southernmaryland": "2W6",
                                "collegepark": "IAD",
                                "cumberlandvalley": "CBE",
                                "frederick": "FDK",
                                "westernmaryland": "CBE",
                                "silverspring": "IAD",
                                "springfield": "CEF",
                                "boston": "BOS",
                                "capecod": "PVC",
                                "southcoast": "EWB",
                                "manchesterma": "BOS",
                                "worcester": "ORH",
                                "annarbor": "ARB",
                                "battlecreek": "AZO",
                                "detroit": "DTW",
                                "flint": "FNT",
                                "grandrapids": "GRR",
                                "jackson": "JXN",
                                "kalamazoo": "AZO",
                                "lansing": "LAN",
                                "monroemi": "TTF",
                                "northernmichigan": "TVC",
                                "minneapolis": "MSP",
                                "duluthmn": "DLH",
                                "rochestermn": "RST",
                                "stcloud": "STC",
                                "biloxi": "GPT",
                                "northmississippi": "TUP",
                                "jacksonms": "JAN",
                                "hattiesburg": "HBG",
                                "meridian": "MEI",
                                "saintlouis": "STL",
                                "columbiamo": "COU",
                                "joplin": "JLN",
                                "kansascity": "MCI",
                                "lakeoftheozarks": "AIZ",
                                "billings": "BIL",
                                "grandisland": "GRI",
                                "greatfalls": "GTF",
                                "lincoln": "LNK",
                                "omaha": "OMA",
                                "elko": "EKO",
                                "reno": "RNO",
                                "concordnh": "MHT",
                                "manchester": "MHT",
                                "merrimack": "MHT",
                                "nashua": "MHT",
                                "newhampshirenh": "MHT",
                                "southjersey": "MIV",
                                "northjersey": "EWR",
                                "centraljersey": "47N",
                                "jerseyshore": "ACY",
                                "mountlaurel": "PHL",
                                "secaucus": "EWR",
                                "albuquerque": "ABQ",
                                "farmington": "FMN",
                                "santafe": "SAF",
                                "albany": "ALB",
                                "queens": "JFK",
                                "brooklyn": "JFK",
                                "longisland": "ISP",
                                "bronx": "JFK",
                                "buffalo": "BUF",
                                "chautauqua": "JHW",
                                "westchesterny": "HPN",
                                "hudsonvalley": "SWF",
                                "ithaca": "ITH",
                                "manhattan": "JFK",
                                "newyork": "JFK",
                                "rochester": "ROC",
                                "plattsburgh": "PBG",
                                "ronkonkoma": "ISP",
                                "statenisland": "JFK",
                                "syracuse": "SYR",
                                "watertown": "ART",
                                "asheville": "AVL",
                                "charlotte": "CLT",
                                "raleigh": "RDU",
                                "easternnorthcarolina": "PGV",
                                "fayetteville": "FAY",
                                "greensboro": "GSO",
                                "wilmington": "ILM",
                                "bismarck": "BIS",
                                "fargo": "FAR",
                                "grandforks": "GFK",
                                "minot": "MOT",
                                "northdakota": "FAR",
                                "akron": "CAK",
                                "ashtabula": "HZY",
                                "cincinnati": "CVG",
                                "cleveland": "CLE",
                                "columbus": "CMH",
                                "dayton": "DAY",
                                "ohio": "CMH",
                                "toledo": "TOL",
                                "youngstown": "YNG",
                                "oklahomacity": "OKC",
                                "tulsa": "TUL",
                                "bend": "RDM",
                                "eugene": "EUG",
                                "medford": "MFR",
                                "portland": "PDX",
                                "salem": "SLE",
                                "allentown": "ABE",
                                "altoona": "AOO",
                                "philadelphia": "PHL",
                                "pittsburgh": "PIT",
                                "harrisburg": "MDT",
                                "lancaster": "LNS",
                                "poconos": "MPO",
                                "scranton": "AVP",
                                "reading": "RDG",
                                "williamsport": "IPT",
                                "york": "THV",
                                "providence": "PVD",
                                "pawtucket": "PVD",
                                "charleston": "CHS",
                                "columbia": "CAE",
                                "florencesc": "FLO",
                                "greenville": "GSP",
                                "myrtlebeach": "MYR",
                                "fortpierre": "PIR",
                                "rapidcity": "RAP",
                                "chattanooga": "CHA",
                                "clarksville": "CKV",
                                "cookeville": "SRB",
                                "memphis": "MEM",
                                "tricitiestn": "TRI",
                                "knoxville": "TYS",
                                "nashville": "BNA",
                                "abilene": "ABI",
                                "amarillo": "AMA",
                                "dallas": "DFW",
                                "austin": "AUS",
                                "beaumont": "BPT",
                                "fortworth": "DFW",
                                "collegestation": "CLL",
                                "corpuschristi": "CRP",
                                "denton": "DFW",
                                "elpaso": "ELP",
                                "galveston": "GLS",
                                "houston": "IAH",
                                "huntsvilletx": "UTS",
                                "killeen": "GRK",
                                "laredo": "LRD",
                                "tyler": "TYR",
                                "lubbock": "LBB",
                                "mcallen": "MFE",
                                "odessa": "MFA",
                                "sanantonio": "SAT",
                                "sanmarcos": "HYI",
                                "texarkana": "TXK",
                                "waco": "ACT",
                                "victoria": "VCT",
                                "wichitafalls": "SPS",
                                "saltlakecity": "SLC",
                                "ogden": "OGD",
                                "provo": "PVU",
                                "stgeorge": "SGU",
                                "brattleboro": "BTV",
                                "burlington": "BTV",
                                "northernvirginia": "IAD",
                                "arlington": "IAD",
                                "fredericksburg": "EZF",
                                "hamptonva": "ORF",
                                "newportnews": "ORF",
                                "norfolk": "ORF",
                                "richmond": "RIC",
                                "roanoke": "ROA",
                                "virginiabeach": "ORF",
                                "seattle": "SEA",
                                "bellingham": "BLI",
                                "everett": "PAE",
                                "tacoma": "TCM",
                                "tricities": "PSC",
                                "moseslake": "MWH",
                                "mtvernon": "BVS",
                                "spokane": "GEG",
                                "yakima": "YKM",
                                "charlestonwv": "CRW",
                                "martinsburg": "MRB",
                                "morgantown": "MGW",
                                "greenbay": "GRB",
                                "racine": "RAC",
                                "madison": "MSN",
                                "milwaukee": "MKE",
                                "sheboygan": "SBM",
                                "wyoming": "CPR",
                                "calgary": "YYC",
                                "edmonton": "YEG",
                                "ftmcmurray": "YMM",
                                "lethbridge": "YQL",
                                "reddeer": "YQF",
                                "abbotsford": "YXX",
                                "burnaby": "YVR",
                                "comoxvalley": "YQQ",
                                "kelowna": "YLW",
                                "langley": "YXX",
                                "kamloops": "YKA",
                                "nanaimo": "YCD",
                                "princegeorge": "YXS",
                                "richmondbc": "YVR",
                                "surrey": "YVR",
                                "vancouver": "YVR",
                                "victoriaca": "YYJ",
                                "whistler": "YWS",
                                "winnipeg": "YWG",
                                "fredericton": "YQM",
                                "moncton": "YQM",
                                "newbrunswickca": "YQM",
                                "stjohnscanl": "YYT",
                                "yellowknife": "YZF",
                                "halifax": "YHZ",
                                "barrie": "QEB",
                                "brampton": "YYZ",
                                "burlingtonca": "YHM",
                                "etobicoke": "YYZ",
                                "guelph": "CNC4",
                                "hamilton": "YHM",
                                "kingstonca": "YGK",
                                "kitchener": "YKF",
                                "londonca": "YXU",
                                "markham": "YYZ",
                                "mississauga": "YYZ",
                                "newmarket": "YYZ",
                                "niagarafallsca": "YCM",
                                "northbay": "YYB",
                                "northyork": "YYZ",
                                "oshawa": "YYZ",
                                "ottawa": "YOW",
                                "peterbourough": "YPQ",
                                "pickering": "YYZ",
                                "richmondhill": "YYZ",
                                "saultstemarie": "YAM",
                                "scarborough": "YYZ",
                                "stcatharines": "YCM",
                                "toronto": "YYZ",
                                "sudbury": "YSB",
                                "thunderbay": "YQT",
                                "vaughan": "YYZ",
                                "windsor": "YQG",
                                "woodbridgeca": "YYZ",
                                "yorkca": "YYZ",
                                "dorval": "YUL",
                                "gatineau": "YUL",
                                "laval": "YUL",
                                "longueuil": "YUL",
                                "montreal": "YUL",
                                "quebec": "YQB",
                                "quebeccity": "YQB",
                                "regina": "YQR",
                                "saskatoon": "YXE",
                                "whitehorse": "YXY",
                                "aberdeen": "ABZ",
                                "birminghamgb": "BHX",
                                "brighton": "ESH",
                                "bristolgb": "BRS",
                                "cambridgegb": "CBG",
                                "devon": "EXT",
                                "eastanglia": "NWI",
                                "eastmidlands": "EMA",
                                "edinburgh": "EDI",
                                "glasgow": "GLA",
                                "hampshire": "SOU",
                                "leeds": "LBA",
                                "liverpool": "LPL",
                                "london": "LHR",
                                "manchestergb": "MAN",
                                "newcastle": "NCL",
                                "oxford": "OXF",
                                "sheffield": "DSA",
                                "wales": "CWL",
                                "abudhabi": "AUH",
                                "dubai": "DXB",
                                "amman": "AMM",
                                "bahamas": "NAS",
                                "caribbean": "KIN",
                                "dominicanrepublic": "SDQ",
                                "puertorico": "SJU",
                                "jamaica": "KIN",
                                "virginislands": "STT",
                                "bangkok": "BKK",
                                "duesseldorf": "DUS",
                                "berlinde": "TXL",
                                "frankfurt": "FRA",
                                "hamburg": "HAM",
                                "muenchen": "MUC",
                                "koeln": "CGN",
                                "cabosanlucas": "SJD",
                                "mexicocity": "MEX",
                                "cancun": "CUN",
                                "tijuana": "TIJ",
                                "bajasur": "SJD",
                                "pv": "PVR",
                                "cebu": "CEB",
                                "doha": "DOH",
                                "manila": "MNL",
                                "hongkong": "HKG",
                                "kuwait": "KWI",
                                "iceland": "RKV",
                                "luxembourg": "LUX",
                                "manama": "BAH",
                                "moskva": "SVO",
                                "shanghai": "SHA",
                                "singapore": "SIN",
                                "ahmedabad": "AMD",
                                "bangalore": "BLR",
                                "chandigarh": "IXC",
                                "chennai": "MAA",
                                "delhi": "DEL",
                                "goa": "GOI",
                                "hyderabad": "HYD",
                                "india": "DEL",
                                "kolkata": "CCU",
                                "kerala": "TRV",
                                "indore": "IDR",
                                "mumbai": "BOM",
                                "pune": "PNQ",
                                "surat": "STV",
                                "amsterdam": "AMS",
                                "athina": "ATH",
                                "christchurch": "CHC",
                                "baleares": "PMI",
                                "wellington": "WLG",
                                "auckland": "AKL",
                                "barcelona": "BCN",
                                "madrid": "MAD",
                                "malaga": "AGP",
                                "brasilia": "BSB",
                                "balgariya": "SOF",
                                "portoalegre": "POA",
                                "riodejaneiro": "GIG",
                                "recife": "REC",
                                "salvador": "SSA",
                                "saopaulo": "GRU",
                                "canberra": "CBR",
                                "melbourneau": "MEL",
                                "perth": "PER",
                                "sydney": "SYD",
                                "brussel": "BRU",
                                "bucuresti": "OTP",
                                "budapest": "BUD",
                                "buenosaires": "EZE",
                                "capetown": "CPT",
                                "johannesburg": "JNB",
                                "colombia": "BOG",
                                "costarica": "SJO",
                                "genf": "GVA",
                                "zurich": "ZRH",
                                "grenoble": "GNB",
                                "lille": "LIL",
                                "lyon": "LYS",
                                "nice": "NCE",
                                "paris": "CDG",
                                "helsinki": "HEL",
                                "guam": "GUM",
                                "istanbul": "IST",
                                "telaviv": "TLV",
                                "kobenhavn": "CPH",
                                "porto": "OPO",
                                "lisboa": "LIS",
                                "milano": "MXP",
                                "roma": "FCO",
                                "sardegna": "CAG",
                                "tokyo": "NRT",
                                "osaka-kobe-kyoto": "KIX",
                                "oslo": "OSL",
                                "praha": "PRG",
                                "santiago": "SCL",
                                "seoul": "ICN",
                                "warszawa": "WAW",
                                "wien": "VIE",
                                "coquitlam": "YVR",
                                "parkersburgoh": "PKB",
                                "chambersburg": "N68",
                                "newrivervalley": "BCB",
                                "medicinehat": "YXH",
                                "cariboo": "YXS",
                                "chilliwack": "YXX",
                                "cranbrook": "YXC",
                                "peacerivercounty": "YPE",
                                "skeena": "XCM",
                                "sunshinecoast": "YHS",
                                "bellevilleca": "YTR",
                                "brantford": "YFD",
                                "chatham": "XCM",
                                "cornwall": "YCC",
                                "oakville": "YYZ",
                                "owensound": "YOS",
                                "sarnia": "YZR",
                                "saguenay": "YBG",
                                "sherbrooke": "YSC",
                                "troisrivieres": "YRQ",
                                "kaiserslautern": "RMS",
                                "nuernberg": "NUE",
                                "veracruz": "VER",
                                "jaipur": "JAI",
                                "belfast": "BFS",
                                "dublinie": "DUB",
                                "brisbane": "BNE",
                                "durban": "DUR",
                                "caracas": "CCS",
                                "marseille": "MRS",
                                "guatemala": "GUA",
                                "jerusalem": "JRS",
                                "lapaz": "LPB",
                                "montevideo": "MVD",
                                "okinawa": "OKA",
                                "quito": "UIO",
                                "stockholm": "ARN",
                                "palmharbor": "TPA",
                                "clearwater": "TPA",
                                "saintpetersburg": "TPA",
                                "brandon": "YXU",
                                "redding": "RDD",
                                "cupertino": "SJC",
                                "sunnyvale": "SJC",
                                "paloalto": "SJC",
                                "alpharetta": "ATL",
                                "dunwoody": "ATL",
                                "stonemountain": "ATL",
                                "duluth": "ATL",
                                "rosemead": "EMT",
                                "pasadena": "EMT",
                                "sangabriel": "EMT",
                                "baldwinpark": "EMT",
                                "lapuente": "EMT",
                                "westcovina": "EMT",
                                "elmonte": "EMT",
                                "sandimas": "EMT",
                                "yuba": "MYV",
                                "oldtown": "STS",
                                "roseville": "SMF",
                                "hollywoodfl": "FLL",
                                "bocaraton": "FLL",
                                "pompanobeach": "FLL",
                                "greatneck": "JFK",
                                "bohemia": "ISP",
                                "bellport": "ISP",
                                "commack": "ISP",
                                "jacksontn": "MKL",
                                "ames": "AMW",
                                "sparks": "RNO",
                                "anaheim": "SNA",
                                "costamesa": "SNA",
                                "fullerton": "SNA",
                                "yorbalinda": "SNA",
                                "newportbeach": "SNA",
                                "irvine": "SNA",
                                "sanjuancapistrano": "SNA",
                                "alisoviejo": "SNA",
                                "hinesville": "SAV",
                                "vallejo": "OAK",
                                "vacaville": "SMF",
                                "rohnertpark": "STS"}

def cityvibe_url_to_sitekey(url):
    """http://www.cityvibe.com/losangeles/PremiumEscorts/ariel-wla-gfe-incalloutcall/396104"""
    (scheme, netloc, path, params, query, fragment) = urlparse(url)
    sitekey = path.split('/')[1]
    return sitekey

def determineMarketCityvibe(url, title, city, state):
    return marketid_to_market_tuple("url", cityvibe_sitekey_to_marketid[cityvibe_url_to_sitekey(url)])

def determineMarketRedbook_forum(url, title, city, state):
    pass

def determineMarketCityxguide(url, title, city, state):
    pass

def determineMarketCityxguideforum(url, title, city, state):
    pass

def determineMarketRubads(url, title, city, state):
    pass

def determineMarketAnunico(url, title, city, state):
    pass

def determineMarketSipsap(url, title, city, state):
    pass

### ESCORTSINCOLLEGE

escortsincollege_sitekey_to_marketid = {
                                        "Abbotsford, British Columbia": "YXX",
                                        "Abilene, Texas": "ABI",
                                        "Akron, Ohio": "CAK",
                                        "Albany, New York": "ALB",
                                        "Albuquerque, New Mexico": "",
                                        "Allentown, Pennsylvania": "ABE",
                                        "Altoona, Pennsylvania": "AOO",
                                        "Amarillo, Texas": "AMA",
                                        "Anchorage, Alaska": "ANC",
                                        "Ann Arbor, Michigan": "",
                                        "Annapolis, Maryland": "ANP",
                                        "Appleton, Wisconsin": "ATW",
                                        "Asheville, North Carolina": "AVL",
                                        "Ashland, Ohio": "HTS",
                                        "Ashtabula, Ohio": "HZY",
                                        "Athens, Ohio": "ATO",
                                        "Atlanta, Georgia": "ATL",
                                        "Auburn, Alabama": "AUO",
                                        "Augusta, Georgia": "AGS",
                                        "Austin, Texas": "AUS",
                                        "Bakersfield, California": "BFL",
                                        "Baltimore, Maryland": "BWI",
                                        "Barrie, Ontario": "QEB",
                                        "Baton Rouge, Louisiana": "",
                                        "Battle Creek, Michigan": "AZO",
                                        "Beaumont, Texas": "BPT",
                                        "Belleville, Ontario": "YTR",
                                        "Bellingham, Washington": "BLI",
                                        "Bend, Oregon": "RDM",
                                        "Bigisland, Hawaii": "KOA",
                                        "Biloxi, Mississippi": "GPT",
                                        "Binghamton, New York": "BGM",
                                        "Birmingham, Alabama": "BHM",
                                        "Blacksburg, Virginia": "BCB",
                                        "Bloomington, Indiana": "BMG",
                                        "Boise, Idaho": "BOI",
                                        "Boone, North Carolina": "NC06",
                                        "Boston, Massachusetts": "BOS",
                                        "Boulder, Colorado": "WBU",
                                        "Bowling Green, Kentucky": "BWG",
                                        "Brantford, Ontario": "YFD",
                                        "Brownsville, Texas": "BRO",
                                        "Brunswick, Georgia": "BQK",
                                        "Buffalo, New York": "BUF",
                                        "Calgary, Alberta": "YYC",
                                        "Cape Cod, Massachusetts": "PVC",
                                        "Carbondale, Illinois": "MDH",
                                        "Cariboo, British Columbia": "YXS",
                                        "Catskills, New York": "20N",
                                        "Cedar Rapids, Iowa": "CID",
                                        "Central Jersey, New Jersey": "47N",
                                        "Central Michigan, Michigan": "LAN",
                                        "Chambana, Illinois": "CMI",
                                        "Chambersburg, Pennsylvania": "N68",
                                        "Charleston, South Carolina": "CHS",
                                        "Charleston, West Virginia": "CRW",
                                        "Charlotte, North Carolina": "CLT",
                                        "Charlottesville, Virginia": "CHO",
                                        "Chatham, Ontario": "XCM",
                                        "Chattanooga, Tennessee": "CHA",
                                        "Chautauqua, New York": "JHW",
                                        "Chesapeake, Virginia": "ORF",
                                        "Chicago, Illinois": "ORD",
                                        "Chico, California": "CIC",
                                        "Chillicothe, Ohio": "RZT",
                                        "Cincinnati, Ohio": "CVG",
                                        "Cleveland, Ohio": "CLE",
                                        "College Station, Texas": "CLL",
                                        "Colorado Springs, Colorado": "COS",
                                        "Columbia, Missouri": "COU",
                                        "Columbia, South Carolina": "CAE",
                                        "Columbus, Ohio": "CMH",
                                        "Comox Valley, British Columbia": "YQQ",
                                        "Cornwall, Ontario": "YCC",
                                        "Corpus Christi, Texas": "CRP",
                                        "Corvallis, Oregon": "CVO",
                                        "Cranbrook, British Columbia": "YXC",
                                        "Cumberland Valley, Maryland": "CBE",
                                        "Dallas, Texas": "DFW",
                                        "Danville, Virginia": "DAN",
                                        "Dayton, Ohio": "DAY",
                                        "Daytona, Florida": "DAB",
                                        "Decatur, Illinois": "DEC",
                                        "Denton, Texas": "DFW",
                                        "Denver, Colorado": "DEN",
                                        "Des Moines, Iowa": "DSM",
                                        "Detroit, Michigan": "DTW",
                                        "Dothan, Alabama": "DHN",
                                        "Dubuque, Iowa": "DBQ",
                                        "Duluth, Minnesota": "DLH",
                                        "East Bay, California": "OAK",
                                        "East Idaho, Idaho": "IDA",
                                        "East Kentucky, Kentucky": "PBX",
                                        "East Oregon, Oregon": "PDT",
                                        "Eastern Connecticut, Connecticut": "GOT",
                                        "Eastern NC, North Carolina": "PGV",
                                        "Eastern Shore, Maryland": "SBY",
                                        "Eauclaire, Wisconsin": "EAU",
                                        "Edmonton, Alberta": "YEG",
                                        "El Paso, Texas": "ELP",
                                        "Elmira, New York": "ELM",
                                        "Erie, Pennsylvania": "ERI",
                                        "Eugene, Oregon": "EUG",
                                        "Evansville, Indiana": "EVV",
                                        "Everett, Washington": "PAE",
                                        "Fargo, North Dakota": "FAR",
                                        "Fayetteville, North Carolina": "FAY",
                                        "Finger Lakes, New York": "D82",
                                        "Flagstaff, Arizona": "FLG",
                                        "Flint, Michigan": "FNT",
                                        "Florence, South Carolina": "FLO",
                                        "Fort Collins, Colorado": "FNL",
                                        "Fort Dodge, Iowa": "FOD",
                                        "Fort Mcmurray, Alberta": "YMM",
                                        "Fort Myers, Florida": "RSW",
                                        "Fort Smith, Arkansas": "FSM",
                                        "Fort Wayne, Indiana": "FWA",
                                        "Frederick, Maryland": "FDK",
                                        "Fredericksburg, Virginia": "EZF",
                                        "Fresno, California": "FAT",
                                        "Ft Lauderdale, Florida": "FLL",
                                        "Gadsden, Alabama": "GAD",
                                        "Gainesville, Florida": "GNV",
                                        "Galveston, Texas": "GLS",
                                        "Glens Falls, New York": "GFL",
                                        "Grand Island, Nebraska": "GRI",
                                        "Grand Rapids, Michigan": "GRR",
                                        "Green Bay, Wisconsin": "GRB",
                                        "Greensboro, North Carolina": "GSO",
                                        "Greenville, South Carolina": "GSP",
                                        "Guelph, Ontario": "CNC4",
                                        "Hamilton, Ontario": "YHM",
                                        "Hampton, Virginia": "ORF",
                                        "Harrisburg, Pennsylvania": "MDT",
                                        "Harrisonburg, Virginia": "SHD",
                                        "Hartford, Connecticut": "HFD",
                                        "Hattiesburg, Mississippi": "HBG",
                                        "Hickory, North Carolina": "HKY",
                                        "Hilton Head, South Carolina": "HHH",
                                        "Honolulu, Hawaii": "HNL",
                                        "Houston, Texas": "IAH",
                                        "Hudson Valley, New York": "SWF",
                                        "Humboldt County, California": "ACV",
                                        "Huntington, West Virginia": "HTS",
                                        "Huntsville, Alabama": "HSV",
                                        "Huntsville, Texas": "UTS",
                                        "Indianapolis, Indiana": "IND",
                                        "Inland Empire, California": "ONT",
                                        "Iowa City, Iowa": "IOW",
                                        "Ithaca, New York": "ITH",
                                        "Jackson, Mississippi": "JAN",
                                        "Jacksonville, Florida": "JAX",
                                        "Janesville, Wisconsin": "JVL",
                                        "Jersey Shore, New Jersey": "ACY",
                                        "Jonesboro, Arkansas": "JBR",
                                        "Joplin, Missouri": "JLN",
                                        "Kalamazoo, Michigan": "AZO",
                                        "Kamloops, British Columbia": "YKA",
                                        "Kansas City, Missouri": "MCI",
                                        "Kauai, Hawaii": "LIH",
                                        "Kelowna, British Columbia": "YLW",
                                        "Keys, Florida": "EYW",
                                        "Killeen, Texas": "GRK",
                                        "Kingston, Ontario": "YGK",
                                        "Kirksville, Missouri": "IRK",
                                        "Kitchener, Ontario": "YKF",
                                        "Knoxville, Tennessee": "TYS",
                                        "Kokomo, Indiana": "OKK",
                                        "La Crosse, Wisconsin": "",
                                        "LaSalle, Illinois": "VYS",
                                        "Lafayette, Louisiana": "LFT",
                                        "Lake Charles, Louisiana": "LCH",
                                        "Lake Of The Ozarks, Missouri": "AIZ",
                                        "Lakeland, Florida": "LAL",
                                        "Lancaster, Pennsylvania": "LNS",
                                        "Lansing, Michigan": "LAN",
                                        "Laredo, Texas": "LRD",
                                        "Las Vegas, Nevada": "LAS",
                                        "Lawrence, Kansas": "LWC",
                                        "Lawton, Oklahoma": "LAW",
                                        "Lethbridge, Alberta": "YQL",
                                        "Lewiston, Idaho": "LWS",
                                        "Lexington, Kentucky": "LEX",
                                        "Lima, Ohio": "LIM",
                                        "Little Rock, Arkansas": "LIT",
                                        "Logan, Utah": "LGU",
                                        "London, Ontario": "YXU",
                                        "Long Beach, California": "LGB",
                                        "Los Angeles, California": "LAX",
                                        "Louisville, Kentucky": "SDF",
                                        "Lubbock, Texas": "LBB",
                                        "Lynchburg, Virginia": "LYH",
                                        "Macon, Georgia": "MCN",
                                        "Madison, Wisconsin": "MSN",
                                        "Manchester, New Hampshire": "MHT",
                                        "Manhattan, Kansas": "MHK",
                                        "Mankato, Minnesota": "MKT",
                                        "Mansfield, Ohio": "MFD",
                                        "Martinsburg, West Virginia": "MRB",
                                        "Mason City, Iowa": "MCW",
                                        "Mattoon, Illinois": "MTO",
                                        "Maui, Hawaii": "OGG",
                                        "Mcallen, Texas": "MFE",
                                        "Meadville, Pennsylvania": "GKJ",
                                        "Medford, Oregon": "MFR",
                                        "Memphis, Tennessee": "MEM",
                                        "Mendocino, California": "UKI",
                                        "Merced, California": "MCE",
                                        "Meridian, Mississippi": "MEI",
                                        "Miami, Florida": "MIA",
                                        "Milwaukee, Wisconsin": "MKE",
                                        "Minneapolis, Minnesota": "MSP",
                                        "Mobile, Alabama": "MOB",
                                        "Modesto, California": "MOD",
                                        "Mohave, Arizona": "IFP",
                                        "Monroe, Michigan": "TTF",
                                        "Monterey, California": "MRY",
                                        "Montgomery, Alabama": "MGM",
                                        "Montreal, Quebec": "YUL",
                                        "Morgantown, West Virginia": "MGW",
                                        "Moses Lake, Washington": "MWH",
                                        "Muncie, Indiana": "MIE",
                                        "Muskegon, Michigan": "MKG",
                                        "Myrtle Beach, South Carolina": "MYR",
                                        "Nanaimo, British Columbia": "YCD",
                                        "Nashville, Tennessee": "BNA",
                                        "Natchez, Mississippi": "HEZ",
                                        "New Haven, Connecticut": "HVN",
                                        "New Orleans, Louisiana": "MSY",
                                        "New York, New York": "JFK",
                                        "Newport News, Virginia": "ORF",
                                        "Niagara, Ontario": "YCM",
                                        "Norfolk, Virginia": "ORF",
                                        "North Jersey, New Jersey": "EWR",
                                        "North Platte, Nebraska": "LBF",
                                        "Northern Michigan, Michigan": "TVC",
                                        "Northern Mississippi, Mississippi": "TUP",
                                        "Northern Virginia, Dc": "IAD",
                                        "Northwest Connecticut, Connecticut": "DXR",
                                        "Northwest Georgia, Georgia": "RMG",
                                        "Ocala, Florida": "OCF",
                                        "Odessa, Texas": "MAF",
                                        "Ogden, Utah": "OGD",
                                        "Oklahoma City, Oklahoma": "OKC",
                                        "Olympia, Washington": "TCM",
                                        "Omaha, Nebraska": "OMA",
                                        "Oneonta, New York": "ONH",
                                        "Orange County, California": "SNA",
                                        "Oregon Coast, Oregon": "ONP",
                                        "Orlando, Florida": "MCO",
                                        "Ottawa, Ontario": "YOW",
                                        "Ottumwa, Iowa": "OTM",
                                        "Outer Banks, North Carolina": "FFA",
                                        "Owen Sound, Ontario": "YOS",
                                        "Owensboro, Kentucky": "OWB",
                                        "Palmdale, California": "PMD",
                                        "Palms Prings, California": "PSP",
                                        "Panama City, Florida": "PFN",
                                        "Parkersburg, West Virginia": "PKB",
                                        "Pennstate, Pennsylvania": "UNV",
                                        "Pensacola, Florida": "PNS",
                                        "Peoria, Illinois": "PIA",
                                        "Peterborough, Ontario": "YPQ",
                                        "Philadelphia, Pennsylvania": "PHL",
                                        "Phoenix, Arizona": "PHX",
                                        "Pittsburgh, Pennsylvania": "PIT",
                                        "Plattsburgh, New York": "PBG",
                                        "Poconos, Pennsylvania": "MPO",
                                        "Port Huron, Michigan": "PHN",
                                        "Portland, Oregon": "PDX",
                                        "Portsmouth, Maine": "PWM",
                                        "Portsmouth, Virginia": "ORF",
                                        "Potsdam, New York": "PTD",
                                        "Prescott, Arizona": "PRC",
                                        "Prince George, British Columbia": "YXS",
                                        "Provo, Utah": "PVU",
                                        "Pueblo, Colorado": "PUB",
                                        "Puerto Rico, Puerto Rico": "SJU",
                                        "Pullman, Washington": "PUW",
                                        "Quad Cities, Iowa": "MLI",
                                        "Quebec, Quebec": "YQB",
                                        "Quincy, Illinois": "UIN",
                                        "Racine, Wisconsin": "RAC",
                                        "Raleigh, North Carolina": "RDU",
                                        "Reading, Pennsylvania": "RDG",
                                        "Red Deer, Alberta": "YQF",
                                        "Redding, California": "RDD",
                                        "Regina, Saskatchewan": "YQR",
                                        "Reno, Nevada": "RNO",
                                        "Richmond, Virginia": "RIC",
                                        "Riverside, California": "ONT",
                                        "Roanoke, Virginia": "ROA",
                                        "Rochester, New York": "ROC",
                                        "Rockford, Illinois": "RFD",
                                        "Rockies, Colorado": "EGE",
                                        "Roseburg, Oregon": "RBG",
                                        "ST. Augustine, Florida": "UST",
                                        "Sacramento, California": "SMF",
                                        "Saginaw, Michigan": "MBS",
                                        "Saguenay, Quebec": "YBG",
                                        "Salem, North Carolina": "INT",
                                        "Salem, Oregon": "SLE",
                                        "Salt Lake City, Utah": "SLC",
                                        "San Antonio, Texas": "SAT",
                                        "San Bernardino, California": "ONT",
                                        "San Diego, California": "SAN",
                                        "San Fernando, California": "BUR",
                                        "San Francisco, California": "SFO",
                                        "San Jose, California": "SJC",
                                        "San Luis Obispo, California": "SBP",
                                        "San Marcos, Texas": "HYI",
                                        "Sandusky, Ohio": "SKY",
                                        "Santa Barbara, California": "SBA",
                                        "Santa Cruz, California": "WVI",
                                        "Santa Maria, California": "SMX",
                                        "Santafe, New Mexico": "SAF",
                                        "Sarasota, Florida": "SRQ",
                                        "Sarnia, Ontario": "YZR",
                                        "Saskatoon, Saskatchewan": "YXE",
                                        "Sault, Ontario": "YAM",
                                        "Savannah, Georgia": "SAV",
                                        "Scotts Bluff, Nebraska": "BFF",
                                        "Scranton, Pennsylvania": "AVP",
                                        "Seattle, Washington": "SEA",
                                        "Sheboygan, Wisconsin": "SBM",
                                        "Sherbrooke, Quebec": "YSC",
                                        "Shoals, Alabama": "MSL",
                                        "Showlow, Arizona": "SOW",
                                        "Shreveport, Louisiana": "SHV",
                                        "Sierra Vista, Arizona": "FHU",
                                        "Sioux City, Iowa": "SUX",
                                        "Siskiyou, California": "SIY",
                                        "Skeena, British Columbia": "XCM",
                                        "South Bend, Indiana": "SBN",
                                        "South Coast, Massachusetts": "EWB",
                                        "South Jersey, New Jersey": "MIV",
                                        "Southeast Missouri, Missouri": "CGI",
                                        "Southern Maryland, Dc": "2W6",
                                        "Southern West Virgin, West Virginia": "BKW",
                                        "Southwest Michigan, Michigan": "BEH",
                                        "Southwest Virginia, Virginia": "MKJ",
                                        "Space Coast, Florida": "TIX",
                                        "Spokane, Washington": "GEG",
                                        "Springfield, Illinois": "SPI",
                                        "Springfield, Massachusetts": "CEF",
                                        "Springfield, Missouri": "SGF",
                                        "St Cloud, Minnesota": "STC",
                                        "St George, Utah": "SGU",
                                        "St Joseph, Missouri": "STJ",
                                        "St Louis, Missouri": "STL",
                                        "Statesboro, Georgia": "TBR",
                                        "Stillwater, Oklahoma": "SWO",
                                        "Sudbury, Ontario": "YSB",
                                        "Suffolk, Virginia": "ORF",
                                        "Sunshine, British Columbia": "YHS",
                                        "Susanville, California": "SVE",
                                        "Syracuse, New York": "SYR",
                                        "Tacoma, Washington": "TCM",
                                        "Tallahassee, Florida": "TLH",
                                        "Tampa, Florida": "TPA",
                                        "Terre Haute, Indiana": "HUF",
                                        "Texarkana, Texas": "TXK",
                                        "Texoma, Texas": "GYI",
                                        "Thunderbay, Ontario": "YQT",
                                        "Toledo, Ohio": "TOL",
                                        "Topeka, Kansas": "FOE",
                                        "Toronto, Ontario": "YYZ",
                                        "Treasure Coast, Florida": "VRB",
                                        "Tri Cities, Washington": "PSC",
                                        "Trois Rivieres, Quebec": "YRQ",
                                        "Tucson, Arizona": "TUS",
                                        "Tulsa, Oklahoma": "TUL",
                                        "Tuscaloosa, Alabama": "TCL",
                                        "Tuscarawas, Ohio": "PHD",
                                        "Twin Falls, Idaho": "TWF",
                                        "Twintiers, New York": "OLE",
                                        "Tyler, Texas": "TYR",
                                        "Upper Peninsula, Michigan": "MQT",
                                        "Utica, New York": "UCA",
                                        "Valdosta, Georgia": "VLD",
                                        "Vancouver, British Columbia": "YVR",
                                        "Ventura, California": "OXR",
                                        "Victoria, British Columbia": "YYJ",
                                        "Virginia Beach, Virginia": "ORF",
                                        "Visalia, California": "VIS",
                                        "Waco, Texas": "ACT",
                                        "Washington DC, Dc": "IAD",
                                        "Waterloo, Iowa": "ALO",
                                        "Watertown, New York": "ART",
                                        "Wausau, Wisconsin": "AUW",
                                        "Wenatchee, Washington": "EAT",
                                        "West Kentucky, Kentucky": "PAH",
                                        "West Palm Beach, Florida": "PBI",
                                        "West Slope, Colorado": "GJT",
                                        "Western Maryland, Maryland": "CBE",
                                        "Wheeling, West Virginia": "HLG",
                                        "Whistler, British Columbia": "YWS",
                                        "Wichita Falls, Texas": "SPS",
                                        "Wichita, Kansas": "ICT",
                                        "Williamsport, Pennsylvania": "IPT",
                                        "Wilmington, North Carolina": "ILM",
                                        "Windsor, Ontario": "YQG",
                                        "Worcester, Massachusetts": "ORH",
                                        "Yakima, Washington": "YKM",
                                        "York, Pennsylvania": "THV",
                                        "Youngstown, Ohio": "YNG",
                                        "Yuma, Arizona": "YUM",
                                        "Zanesville, Ohio": "ZZV"}

def escortsincollege_title_to_sitekey(title):
    """202-277-7628 - Escort ad in Atlanta, Georgia | Visiting Visiting Visiting"""
    start = 28
    end = title.index('|')
    sitekey = title[start:end].strip()
    return sitekey

def determineMarketEscortsincollege(url, title, city, state):
    return marketid_to_market_tuple("title", escortsincollege_sitekey_to_marketid[escortsincollege_title_to_sitekey(title)])

### ESCORTPHONELIST

escortphonelist_sitekey_to_marketid = escortsincollege_sitekey_to_marketid

def escortphonelist_title_to_sitekey(title):
    """"602-330-8931 - Escort ad in Phoenix, Arizona | Sexy Latina With Huge Ll Natural Ddd's $100 !!"""
    start = 28
    end = title.index('|')
    sitekey = title[start:end].strip()
    return sitekey

def determineMarketEscortphonelist(url, title, city, state):
    return marketid_to_market_tuple("title", escortphonelist_sitekey_to_marketid[escortphonelist_title_to_sitekey(title)])

### EROTICMUGSHOTS
### MASSAGETROLL

eroticmugshots_massagetroll_sitekey_to_marketid = {
                                      "abbotsford": "YXX",
                                      "aberdeen": "ABZ",
                                      "abilene": "ABI",
                                      "adelaide": "ADL",
                                      "akron": "CAK",
                                      "albany": "ALB",
                                      "albuquerque": "ABQ",
                                      "allentown": "ABE",
                                      "altoona": "AOO",
                                      "amarillo": "AMA",
                                      "anchorage": "ANC",
                                      "annapolis": "ANP",
                                      "annarbor": "ARB",
                                      "appleton": "ATW",
                                      "asheville": "AVL",
                                      "ashland": "MFR",
                                      "ashtabula": "HZY",
                                      "athens": "ATO",
                                      "atlanta": "ATL",
                                      "auburn": "AUO",
                                      "augusta": "AGS",
                                      "austin": "AUS",
                                      "bakersfield": "BFL",
                                      "baltimore": "BWI",
                                      "barrie": "QEB",
                                      "batonrouge": "BTR",
                                      "battlecreek": "AZO",
                                      "beaumont": "BPT",
                                      "belleville": "YTR",
                                      "bellingham": "BLI",
                                      "bend": "RDM",
                                      "bigisland": "KOA",
                                      "biloxi": "GPT",
                                      "binghamton": "BGM",
                                      "birmingham": "BHM",
                                      "birminghamuk": "BHX",
                                      "blacksburg": "BCB",
                                      "bloomington": "BMG",
                                      "boise": "BOI",
                                      "boone": "NC06",
                                      "boston": "BOS",
                                      "boulder": "WBU",
                                      "bowlinggreen": "BWG",
                                      "brantford": "YFD",
                                      "brighton": "ESH",
                                      "brisbane": "BNE",
                                      "bristol": "BRS",
                                      "brownsville": "BRO",
                                      "brunswick": "BQK",
                                      "buffalo": "BUF",
                                      "calgary": "YYC",
                                      "cambridge": "CBG",
                                      "canberra": "CBR",
                                      "capecod": "PVC",
                                      "carbondale": "MDH",
                                      "cariboo": "YXS",
                                      "catskills": "20N",
                                      "cedarrapids": "CID",
                                      "centralmichigan": "LAN",
                                      "chambana": "CMI",
                                      "chambersburg": "N68",
                                      "charlestonsc": "CHS",
                                      "charlestonwv": "CRW",
                                      "charlotte": "CLT",
                                      "charlottesville": "CHO",
                                      "chatham": "XCM",
                                      "chattanooga": "CHA",
                                      "chautauqua": "JHW",
                                      "chesapeake": "ORF",
                                      "chicago": "ORD",
                                      "chico": "CIC",
                                      "chillicothe": "RZT",
                                      "cincinnati": "CVG",
                                      "cleveland": "CLE",
                                      "collegestation": "CLL",
                                      "coloradosprings": "COS",
                                      "columbia": "COU",
                                      "columbiasc": "CAE",
                                      "columbus": "CMH",
                                      "comoxvalley": "YQQ",
                                      "cornwall": "YCC",
                                      "corpuschristi": "CRP",
                                      "corvallis": "CVO",
                                      "cranbrook": "YXC",
                                      "cumberlandvalley": "N68",
                                      "dallas": "DFW",
                                      "danville": "DAN",
                                      "dayton": "DAY",
                                      "daytona": "DAY",
                                      "decatur": "DEC",
                                      "denton": "DFW",
                                      "denver": "DEN",
                                      "desmoines": "DSM",
                                      "detroit": "DTW",
                                      "devon": "EXT",
                                      "dothan": "DHN",
                                      "dubuque": "DBQ",
                                      "duluth": "DLH",
                                      "eastanglia": "NWI",
                                      "eastbay": "OAK",
                                      "easternconnecticut": "GON",
                                      "easternnc": "PGV",
                                      "easternshore": "SBY",
                                      "eastidaho": "IDA",
                                      "eastkentucky": "PBX",
                                      "eastmidlands": "EMA",
                                      "eastoregon": "PDT",
                                      "eauclaire": "EAU",
                                      "edinburgh": "EDI",
                                      "edmonton": "YEG",
                                      "elmira": "ELM",
                                      "elpaso": "ELP",
                                      "erie": "ERI",
                                      "eugene": "EUG",
                                      "evansville": "EVV",
                                      "everett": "PAE",
                                      "fargo": "FAR",
                                      "fayetteville": "FAY",
                                      "fingerlakes": "D82",
                                      "flagstaff": "FLG",
                                      "flint": "FNT",
                                      "florence": "FLO",
                                      "fortcollins": "FNL",
                                      "fortdodge": "FOD",
                                      "fortmcmurray": "YMM",
                                      "fortmyers": "RSW",
                                      "fortsmith": "FSM",
                                      "fortwayne": "FWA",
                                      "frederick": "FDK",
                                      "fredericksburg": "EZF",
                                      "fresno": "FAT",
                                      "ftlauderdale": "FLL",
                                      "gadsden": "GAD",
                                      "gainesville": "GNV",
                                      "galveston": "GLS",
                                      "glasgow": "GLA",
                                      "glensfalls": "GFL",
                                      "grandisland": "GRI",
                                      "grandrapids": "GRR",
                                      "greenbay": "GRB",
                                      "greensboro": "GSO",
                                      "greenville": "GSP",
                                      "guelph": "CNC4",
                                      "hamilton": "YHM",
                                      "hampshire": "SOU",
                                      "hampton": "ORF",
                                      "harrisburg": "MDT",
                                      "harrisonburg": "SHD",
                                      "hartford": "HFD",
                                      "hattiesburg": "HBG",
                                      "hickory": "HKY",
                                      "hiltonhead": "HHH",
                                      "honolulu": "HNL",
                                      "houston": "IAH",
                                      "hudsonvalley": "SWF",
                                      "humboldt": "HJO",
                                      "huntington": "HTS",
                                      "huntsville": "HSV",
                                      "huntsvilletx": "UTS",
                                      "indianapolis": "IND",
                                      "inlandempire": "ONT",
                                      "iowacity": "IOW",
                                      "ithaca": "ITH",
                                      "jackson": "JAN",
                                      "jacksonville": "JAX",
                                      "janesville": "JVL",
                                      "jerseyshore": "ACY",
                                      "jonesboro": "JBR",
                                      "joplin": "JLN",
                                      "kalamazoo": "AZO",
                                      "kamloops": "YKA",
                                      "kansascity": "MCI",
                                      "kauai": "LIH",
                                      "kelowna": "YLW",
                                      "keys": "EYW",
                                      "killeen": "GRK",
                                      "kingston": "YGK",
                                      "kirksville": "IRK",
                                      "kitchener": "YKF",
                                      "knoxville": "TYS",
                                      "kokomo": "OKK",
                                      "lacrosse": "LSE",
                                      "lafayette": "LFT",
                                      "lakecharles": "LCH",
                                      "lakeland": "LAL",
                                      "lakeoftheozarks": "AIZ",
                                      "lancaster": "LNS",
                                      "lansing": "LAN",
                                      "laredo": "LRD",
                                      "lasalle": "VYS",
                                      "lasvegas": "LAS",
                                      "lawrence": "LWC",
                                      "lawton": "LAW",
                                      "leeds": "LBA",
                                      "lethbridge": "YQL",
                                      "lewiston": "LWS",
                                      "lexington": "LEX",
                                      "lima": "AOH",
                                      "littlerock": "LIT",
                                      "liverpool": "LPL",
                                      "logan": "LGU",
                                      "londonon": "YXU",
                                      "londonuk": "LHR",
                                      "longbeach": "LGB",
                                      "losangeles": "LAX",
                                      "louisville": "SDF",
                                      "lubbock": "LBB",
                                      "lynchburg": "LYH",
                                      "macon": "MCN",
                                      "madison": "MSN",
                                      "manchester": "MAN",
                                      "manchesternh": "MHT",
                                      "manhattan": "MHK",
                                      "mankato": "MKT",
                                      "mansfield": "MFD",
                                      "martinsburg": "MRB",
                                      "masoncity": "MCW",
                                      "mattoon": "MTO",
                                      "maui": "OGG",
                                      "mcallen": "MFE",
                                      "meadville": "GKJ",
                                      "medford": "MFR",
                                      "melbourne": "MEL",
                                      "memphis": "MEM",
                                      "mendocino": "UKI",
                                      "merced": "MCE",
                                      "meridian": "MEI",
                                      "miami": "MIA",
                                      "milwaukee": "MKE",
                                      "minneapolis": "MSP",
                                      "mobile": "MOB",
                                      "modesto": "MOD",
                                      "mohave": "IFP",
                                      "monroe": "TTF",
                                      "monterey": "MRY",
                                      "montgomery": "MGM",
                                      "montreal": "YUL",
                                      "morgantown": "MGW",
                                      "moseslake": "MWH",
                                      "muncie": "MIE",
                                      "muskegon": "MKG",
                                      "myrtlebeach": "MYR",
                                      "nanaimo": "YCD",
                                      "nashville": "BNA",
                                      "natchez": "HEZ",
                                      "newcastle": "NCL",
                                      "newhaven": "HVN",
                                      "neworleans": "MSY",
                                      "newportnews": "ORF",
                                      "newyork": "JFK",
                                      "niagara": "YCM",
                                      "norfolk": "ORF",
                                      "northernmichigan": "TVC",
                                      "northernmississippi": "TUP",
                                      "northjersey": "EWR",
                                      "northplatte": "LBF",
                                      "northwestconnecticut": "DXR",
                                      "northwestgeorgia": "RMG",
                                      "nova": "IAD",
                                      "ocala": "OCF",
                                      "odessa": "MAF",
                                      "ogden": "OGD",
                                      "oklahomacity": "OKC",
                                      "olympia": "TCM",
                                      "omaha": "OMA",
                                      "oneonta": "ONH",
                                      "orangecounty": "SNA",
                                      "oregoncoast": "ONP",
                                      "orlando": "MCO",
                                      "ottawa": "YOW",
                                      "ottumwa": "OTM",
                                      "outerbanks": "FFA",
                                      "owensboro": "OWB",
                                      "owensound": "YOS",
                                      "oxford": "OXF",
                                      "palmdale": "PMD",
                                      "palmsprings": "PSP",
                                      "panamacity": "PFN",
                                      "parkersburg": "PKB",
                                      "pennstate": "UNV",
                                      "pensacola": "PNS",
                                      "peoria": "PIA",
                                      "perth": "PER",
                                      "peterborough": "YPQ",
                                      "philadelphia": "PHL",
                                      "phoenix": "PHX",
                                      "pittsburgh": "PIT",
                                      "plattsburgh": "PBG",
                                      "poconos": "MPO",
                                      "porthuron": "PHN",
                                      "portland": "PDX",
                                      "portsmouth": "ORF",
                                      "portsmouthme": "PWM",
                                      "potsdam": "MSS",
                                      "prescott": "PRC",
                                      "princegeorge": "YXS",
                                      "provo": "PVU",
                                      "pueblo": "PUB",
                                      "puertorico": "SJU",
                                      "pullman": "PUW",
                                      "quadcities": "MLI",
                                      "quebec": "YQB",
                                      "quincy": "UIN",
                                      "racine": "RAC",
                                      "raleigh": "RDU",
                                      "reading": "RDG",
                                      "reddeer": "YQF",
                                      "redding": "RDD",
                                      "reno": "RNO",
                                      "richmond": "RIC",
                                      "riverside": "ONT",
                                      "roanoke": "ROA",
                                      "rochester": "ROC",
                                      "rockford": "RFD",
                                      "rockies": "EGE",
                                      "roseburg": "RBG",
                                      "sacramento": "SMF",
                                      "saginaw": "MBS",
                                      "salem": "SLE",
                                      "saltlakecity": "SLC",
                                      "sanantonio": "SAT",
                                      "sanbernardino": "ONT",
                                      "sandiego": "SAN",
                                      "sandusky": "SKY",
                                      "sanfernandovalley": "BUR",
                                      "sanfrancisco": "SFO",
                                      "sanjose": "SJC",
                                      "sanluisobispo": "SBP",
                                      "sanmarcos": "HYI",
                                      "santabarbara": "SBA",
                                      "santacruz": "WVI",
                                      "santafe": "SAF",
                                      "santamaria": "SMX",
                                      "sarasota": "SRQ",
                                      "sarnia": "YZR",
                                      "saskatoon": "YXE",
                                      "sault": "YAM",
                                      "savannah": "SAV",
                                      "scottsbluff": "BFF",
                                      "scranton": "AVP",
                                      "seattle": "SEA",
                                      "sheboygan": "SBM",
                                      "sheffield": "DSA",
                                      "shoals": "MSL",
                                      "showlow": "SOW",
                                      "shreveport": "SHV",
                                      "sierravista": "FHU",
                                      "siouxcity": "SUX",
                                      "siskiyou": "SIY",
                                      "skeena": "XCM",
                                      "southbend": "SBN",
                                      "southcoast": "EWB",
                                      "southeastmissouri": "CGI",
                                      "southernmaryland": "2W6",
                                      "southernwestvirginia": "BKW",
                                      "southjersey": "MIV",
                                      "southwestmichigan": "BEH",
                                      "spacecoast": "TIX",
                                      "spokane": "GEG",
                                      "springfield": "CEF",
                                      "springfieldmo": "SGF",
                                      "statesboro": "TBR",
                                      "staugustine": "UST",
                                      "stcloud": "STC",
                                      "stgeorge": "SGU",
                                      "stillwater": "SWO",
                                      "stjoseph": "STJ",
                                      "stlouis": "STL",
                                      "sudbury": "YSB",
                                      "suffolk": "ORF",
                                      "sunshine": "YHS",
                                      "susanville": "SVE",
                                      "swva": "MKJ",
                                      "sydney": "SYD",
                                      "syracuse": "SYR",
                                      "tacoma": "TCM",
                                      "tallahassee": "TLH",
                                      "tampa": "TPA",
                                      "terrehaute": "HUF",
                                      "texarkana": "TXK",
                                      "texoma": "GYI",
                                      "thunderbay": "YQT",
                                      "tijuana": "TIJ",
                                      "toledo": "TOL",
                                      "topeka": "FOE",
                                      "toronto": "YYZ",
                                      "treasurecoast": "VRB",
                                      "tricities": "TRI",
                                      "troisrivieres": "YRQ",
                                      "tucson": "TUS",
                                      "tulsa": "TUL",
                                      "tuscaloosa": "TCL",
                                      "tuscarawas": "PHD",
                                      "twinfalls": "TWF",
                                      "twintiers": "OLE",
                                      "tyler": "TYR",
                                      "upperpeninsula": "MQT",
                                      "utica": "UCA",
                                      "valdosta": "VLD",
                                      "vancouver": "YVR",
                                      "ventura": "OXR",
                                      "victoria": "YYJ",
                                      "virginiabeach": "ORF",
                                      "visalia": "VIS",
                                      "waco": "ACT",
                                      "wales": "CWL",
                                      "washingtondc": "IAD",
                                      "waterloo": "YKF",
                                      "watertown": "ART",
                                      "wausau": "AUW",
                                      "wenatchee": "EAT",
                                      "westernmaryland": "CBE",
                                      "westkentucky": "PAH",
                                      "westpalmbeach": "PBI",
                                      "westslope": "GJT",
                                      "wheeling": "HLG",
                                      "whistler": "YWS",
                                      "wichita": "ICT",
                                      "wichitafalls": "SPS",
                                      "williamsport": "IPT",
                                      "wilmington": "ILM",
                                      "windsor": "YQG",
                                      "winston": "INT",
                                      "worcester": "ORH",
                                      "yakima": "YKM",
                                      "york": "THV",
                                      "youngstown": "YNG",
                                      "yuma": "YUM",
                                      "zanesville": "ZZV",
                                      # Massagetroll only
                                      "canton": "CAK",
                                      "centraljersey": "47N",
                                      "findlay": "AOH",
                                      "springfieldil": "SPI",
                                      "stpaul": "MSP"
                                      }

def eroticmugshots_url_to_sitekey(url):
    """http://eroticmugshots_massagetroll.com/houston-escorts/719-492-9016/?pid=6887627"""
    (scheme, netloc, path, params, query, fragment) = urlparse(url)
    d = path.split('/')[1]
    if d.endswith('-escorts'):
        return d[0:-8]
    else:
        return None

def massagetroll_url_to_sitekey(url):
    """http://eroticmugshots_massagetroll.com/houston-escorts/719-492-9016/?pid=6887627"""
    (scheme, netloc, path, params, query, fragment) = urlparse(url)
    d = path.split('/')[1]
    if d.endswith('-massages'):
        return d[0:-9]
    else:
        return None

def determineMarketEroticmugshots(url, title, city, state):
    return marketid_to_market_tuple("url", eroticmugshots_massagetroll_sitekey_to_marketid[eroticmugshots_url_to_sitekey(url)])

def determineMarketMassagetroll(url, title, city, state):
    return marketid_to_market_tuple("url", eroticmugshots_massagetroll_sitekey_to_marketid[massagetroll_url_to_sitekey(url)])

### ESCORTADSXXX
### ESCORTSINCA
### ESCORTSINTHEUS

escorts181920_sitekey_to_marketid = {
                                     ("Abbotsford", "British Columbia"): "YXX",
                                     ("Aberdeen", "Uk"): "ABZ",
                                     ("Abilene", "Texas"): "ABI",
                                     ("Adelaide", "Australia"): "ADL",
                                     ("Akron", "Ohio"): "CAK",
                                     ("Albany", "New York"): "ALB",
                                     ("Albuquerque", "New Mexico"): "ABQ",
                                     ("Allentown", "Pennsylvania"): "ABE",
                                     ("Altoona", "Pennsylvania"): "AOO",
                                     ("Amarillo", "Texas"): "AMA",
                                     ("Anchorage", "Alaska"): "ANC",
                                     ("Ann Arbor", "Michigan"): "ARB",
                                     ("Annapolis", "Maryland"): "ANP",
                                     ("Appleton", "Wisconsin"): "ATW",
                                     ("Asheville", "North Carolina"): "AVL",
                                     ("Ashland", "Ohio"): "HTS",
                                     ("Ashtabula", "Ohio"): "HZY",
                                     ("Athens", "Ohio"): "ATO",
                                     ("Atlanta", "Georgia"): "ATL",
                                     ("Auburn", "Alabama"): "AUO",
                                     ("Augusta", "Georgia"): "AGS",
                                     ("Austin", "Texas"): "AUS",
                                     ("Bakersfield", "California"): "BFL",
                                     ("Baltimore", "Maryland"): "BWI",
                                     ("Barrie", "Ontario"): "QEB",
                                     ("Baton Rouge", "Louisiana"): "BTR",
                                     ("Battle Creek", "Michigan"): "AZO",
                                     ("Beaumont", "Texas"): "BPT",
                                     ("Belleville", "Ontario"): "YTR",
                                     ("Bellingham", "Washington"): "BLI",
                                     ("Bend", "Oregon"): "RDM",
                                     ("Bigisland", "Hawaii"): "KOA",
                                     ("Biloxi", "Mississippi"): "GPT",
                                     ("Binghamton", "New York"): "BGM",
                                     ("Birmingham", "Alabama"): "BHM",
                                     ("Birmingham", "Uk"): "BHX",
                                     ("Blacksburg", "Virginia"): "BCB",
                                     ("Bloomington", "Indiana"): "BMG",
                                     ("Boise", "Idaho"): "BOI",
                                     ("Boone", "North Carolina"): "NC06",
                                     ("Boston", "Massachusetts"): "BOS",
                                     ("Boulder", "Colorado"): "WBU",
                                     ("Bowling Green", "Kentucky"): "BWG",
                                     ("Brantford", "Ontario"): "YFD",
                                     ("Brighton", "Uk"): "ESH",
                                     ("Brisbane", "Australia"): "BNE",
                                     ("Bristol", "Uk"): "BRS",
                                     ("Brownsville", "Texas"): "BRO",
                                     ("Brunswick", "Georgia"): "BQK",
                                     ("Buffalo", "New York"): "BUF",
                                     ("Calgary", "Alberta"): "YYC",
                                     ("Cambridge", "Uk"): "CBG",
                                     ("Canberra", "Australia"): "CBR",
                                     ("Cape Cod", "Massachusetts"): "PVC",
                                     ("Carbondale", "Illinois"): "MDH",
                                     ("Cariboo", "British Columbia"): "YXS",
                                     ("Catskills", "New York"): "20N",
                                     ("Cedar Rapids", "Iowa"): "CID",
                                     ("Central Michigan", "Michigan"): "LAN",
                                     ("Chambana", "Illinois"): "CMI",
                                     ("Chambersburg", "Pennsylvania"): "N68",
                                     ("Charleston", "South Carolina"): "CHS",
                                     ("Charleston", "West Virginia"): "CRW",
                                     ("Charlottesville", "Virginia"): "CHO",
                                     ("Charlotte", "North Carolina"): "CLT",
                                     ("Chatham", "Ontario"): "XCM",
                                     ("Chattanooga", "Tennessee"): "CHA",
                                     ("Chautauqua", "New York"): "JHW",
                                     ("Chesapeake", "Virginia"): "ORF",
                                     ("Chicago", "Illinois"): "ORD",
                                     ("Chico", "California"): "CIC",
                                     ("Chillicothe", "Ohio"): "RZT",
                                     ("Cincinnati", "Ohio"): "CVG",
                                     ("Cleveland", "Ohio"): "CLE",
                                     ("College Station", "Texas"): "CLL",
                                     ("Colorado Springs", "Colorado"): "COS",
                                     ("Columbia", "Missouri"): "COU",
                                     ("Columbia", "South Carolina"): "CAE",
                                     ("Columbus", "Ohio"): "CMH",
                                     ("Comox Valley", "British Columbia"): "YQQ",
                                     ("Cornwall", "Ontario"): "YCC",
                                     ("Corpus Christi", "Texas"): "CRP",
                                     ("Corvallis", "Oregon"): "CVO",
                                     ("Cranbrook", "British Columbia"): "YXC",
                                     ("Cumberland Valley", "Maryland"): "CBE",
                                     ("Dallas", "Texas"): "DFW",
                                     ("Danville", "Virginia"): "DAN",
                                     ("Daytona", "Florida"): "DAB",
                                     ("Dayton", "Ohio"): "DAY",
                                     ("Decatur", "Illinois"): "DEC",
                                     ("Denton", "Texas"): "DFW",
                                     ("Denver", "Colorado"): "DEN",
                                     ("Des Moines", "Iowa"): "DSM",
                                     ("Detroit", "Michigan"): "DTW",
                                     ("Devon", "Uk"): "EXT",
                                     ("Dothan", "Alabama"): "DHN",
                                     ("Dubuque", "Iowa"): "DBQ",
                                     ("Duluth", "Minnesota"): "DLH",
                                     ("East Anglia", "Uk"): "NWI",
                                     ("East Bay", "California"): "OAK",
                                     ("East Idaho", "Idaho"): "IDA",
                                     ("East Kentucky", "Kentucky"): "PBX",
                                     ("East Midlands", "Uk"): "EMA",
                                     ("East Oregon", "Oregon"): "PDT",
                                     ("Eastern Connecticut", "Connecticut"): "GON",
                                     ("Eastern NC", "North Carolina"): "PGV",
                                     ("Eastern Shore", "Maryland"): "SBY",
                                     ("Eauclaire", "Wisconsin"): "EAU",
                                     ("Edinburgh", "Uk"): "EDI",
                                     ("Edmonton", "Alberta"): "YEG",
                                     ("El Paso", "Texas"): "ELP",
                                     ("Elmira", "New York"): "ELM",
                                     ("Erie", "Pennsylvania"): "ERI",
                                     ("Eugene", "Oregon"): "EUG",
                                     ("Evansville", "Indiana"): "EVV",
                                     ("Everett", "Washington"): "PAE",
                                     ("Fargo", "North Dakota"): "FAR",
                                     ("Fayetteville", "North Carolina"): "FAY",
                                     ("Finger Lakes", "New York"): "D82",
                                     ("Flagstaff", "Arizona"): "FLG",
                                     ("Flint", "Michigan"): "FNT",
                                     ("Florence", "South Carolina"): "FLO",
                                     ("Fort Collins", "Colorado"): "FNL",
                                     ("Fort Dodge", "Iowa"): "FOD",
                                     ("Fort Mcmurray", "Alberta"): "YMM",
                                     ("Fort Myers", "Florida"): "RSW",
                                     ("Fort Smith", "Arkansas"): "FSM",
                                     ("Fort Wayne", "Indiana"): "FWA",
                                     ("Fredericksburg", "Virginia"): "EZF",
                                     ("Frederick", "Maryland"): "FDK",
                                     ("Fresno", "California"): "FAT",
                                     ("Ft Lauderdale", "Florida"): "FLL",
                                     ("Gadsden", "Alabama"): "GAD",
                                     ("Gainesville", "Florida"): "GNV",
                                     ("Galveston", "Texas"): "GLS",
                                     ("Glasgow", "Uk"): "GLA",
                                     ("Glens Falls", "New York"): "GFL",
                                     ("Grand Island", "Nebraska"): "GRI",
                                     ("Grand Rapids", "Michigan"): "GRR",
                                     ("Green Bay", "Wisconsin"): "GRB",
                                     ("Greensboro", "North Carolina"): "GSO",
                                     ("Greenville", "South Carolina"): "GSP",
                                     ("Guelph", "Ontario"): "CNC4",
                                     ("Hamilton", "Ontario"): "YHM",
                                     ("Hampshire", "Uk"): "SOU",
                                     ("Hampton", "Virginia"): "ORF",
                                     ("Harrisburg", "Pennsylvania"): "MDT",
                                     ("Harrisonburg", "Virginia"): "SHD",
                                     ("Hartford", "Connecticut"): "HFD",
                                     ("Hattiesburg", "Mississippi"): "HBG",
                                     ("Hickory", "North Carolina"): "HKY",
                                     ("Hilton Head", "South Carolina"): "HHH",
                                     ("Honolulu", "Hawaii"): "HNL",
                                     ("Houston", "Texas"): "IAH",
                                     ("Hudson Valley", "New York"): "SWF",
                                     ("Humboldt County", "California"): "ACV",
                                     ("Huntington", "West Virginia"): "HTS",
                                     ("Huntsville", "Alabama"): "HSV",
                                     ("Huntsville", "Texas"): "UTS",
                                     ("Indianapolis", "Indiana"): "IND",
                                     ("Inland Empire", "California"): "ONT",
                                     ("Iowa City", "Iowa"): "IOW",
                                     ("Ithaca", "New York"): "ITH",
                                     ("Jacksonville", "Florida"): "JAX",
                                     ("Jackson", "Mississippi"): "JAN",
                                     ("Janesville", "Wisconsin"): "JVL",
                                     ("Jersey Shore", "New Jersey"): "ACY",
                                     ("Jonesboro", "Arkansas"): "JBR",
                                     ("Joplin", "Missouri"): "JLN",
                                     ("Kalamazoo", "Michigan"): "AZO",
                                     ("Kamloops", "British Columbia"): "YKA",
                                     ("Kansas City", "Missouri"): "MCI",
                                     ("Kauai", "Hawaii"): "LIH",
                                     ("Kelowna", "British Columbia"): "YLW",
                                     ("Keys", "Florida"): "EYW",
                                     ("Killeen", "Texas"): "GRK",
                                     ("Kingston", "Ontario"): "YGK",
                                     ("Kirksville", "Missouri"): "IRK",
                                     ("Kitchener", "Ontario"): "YKF",
                                     ("Knoxville", "Tennessee"): "TYS",
                                     ("Kokomo", "Indiana"): "OKK",
                                     ("La Crosse", "Wisconsin"): "LSE",
                                     ("LaSalle", "Illinois"): "VYS",
                                     ("Lafayette", "Louisiana"): "LFT",
                                     ("Lake Charles", "Louisiana"): "LCH",
                                     ("Lake Of The Ozarks", "Missouri"): "AIZ",
                                     ("Lakeland", "Florida"): "LAL",
                                     ("Lancaster", "Pennsylvania"): "LNS",
                                     ("Lansing", "Michigan"): "LAN",
                                     ("Laredo", "Texas"): "LRD",
                                     ("Las Vegas", "Nevada"): "LAS",
                                     ("Lawrence", "Kansas"): "LWC",
                                     ("Lawton", "Oklahoma"): "LAW",
                                     ("Leeds", "Uk"): "LBA",
                                     ("Lethbridge", "Alberta"): "YQL",
                                     ("Lewiston", "Idaho"): "LWS",
                                     ("Lexington", "Kentucky"): "LEX",
                                     ("Lima", "Ohio"): "AOH",
                                     ("Little Rock", "Arkansas"): "LIT",
                                     ("Liverpool", "Uk"): "LPL",
                                     ("Logan", "Utah"): "LGU",
                                     ("London", "Ontario"): "YXU",
                                     ("London", "Uk"): "LHR",
                                     ("Long Beach", "California"): "LGB",
                                     ("Los Angeles", "California"): "LAX",
                                     ("Louisville", "Kentucky"): "SDF",
                                     ("Lubbock", "Texas"): "LBB",
                                     ("Lynchburg", "Virginia"): "LYH",
                                     ("Macon", "Georgia"): "MCN",
                                     ("Madison", "Wisconsin"): "MSN",
                                     ("Manchester", "New Hampshire"): "MHT",
                                     ("Manchester", "Uk"): "MAN",
                                     ("Manhattan", "Kansas"): "MHK",
                                     ("Mankato", "Minnesota"): "MKT",
                                     ("Mansfield", "Ohio"): "MFD",
                                     ("Martinsburg", "West Virginia"): "MRB",
                                     ("Mason City", "Iowa"): "MCW",
                                     ("Mattoon", "Illinois"): "MTO",
                                     ("Maui", "Hawaii"): "OGG",
                                     ("Mcallen", "Texas"): "MFE",
                                     ("Meadville", "Pennsylvania"): "GKJ",
                                     ("Medford", "Oregon"): "MFR",
                                     ("Melbourne", "Australia"): "MEL",
                                     ("Memphis", "Tennessee"): "MEM",
                                     ("Mendocino", "California"): "UKI",
                                     ("Merced", "California"): "MCE",
                                     ("Meridian", "Mississippi"): "MEI",
                                     ("Miami", "Florida"): "MIA",
                                     ("Milwaukee", "Wisconsin"): "MKE",
                                     ("Mobile", "Alabama"): "MOB",
                                     ("Modesto", "California"): "MOD",
                                     ("Mohave", "Arizona"): "IFP",
                                     ("Monroe", "Michigan"): "TTF",
                                     ("Monterey", "California"): "MRY",
                                     ("Montgomery", "Alabama"): "MGM",
                                     ("Montreal", "Quebec"): "YUL",
                                     ("Morgantown", "West Virginia"): "MGW",
                                     ("Moses Lake", "Washington"): "MWH",
                                     ("Muncie", "Indiana"): "MIE",
                                     ("Muskegon", "Michigan"): "MKG",
                                     ("Myrtle Beach", "South Carolina"): "MYR",
                                     ("Nanaimo", "British Columbia"): "YCD",
                                     ("Nashville", "Tennessee"): "BNA",
                                     ("Natchez", "Mississippi"): "HEZ",
                                     ("New Haven", "Connecticut"): "HVN",
                                     ("New Orleans", "Louisiana"): "MSY",
                                     ("New York", "New York"): "JFK",
                                     ("Newcastle", "Uk"): "NCL",
                                     ("Newport News", "Virginia"): "ORF",
                                     ("Niagara", "Ontario"): "YCM",
                                     ("Norfolk", "Virginia"): "ORF",
                                     ("North Jersey", "New Jersey"): "EWR",
                                     ("North Platte", "Nebraska"): "LBF",
                                     ("Northern Michigan", "Michigan"): "TVC",
                                     ("Northern Mississippi", "Mississippi"): "TUP",
                                     ("Northern Virginia", "district of columbia"): "IAD",
                                     ("Northwest Connecticut", "Connecticut"): "DXR",
                                     ("Northwest Georgia", "Georgia"): "RMG",
                                     ("Ocala", "Florida"): "OCF",
                                     ("Odessa", "Texas"): "MAF",
                                     ("Ogden", "Utah"): "OGD",
                                     ("Oklahoma City", "Oklahoma"): "OKC",
                                     ("Olympia", "Washington"): "TCM",
                                     ("Omaha", "Nebraska"): "OMA",
                                     ("Oneonta", "New York"): "ONH",
                                     ("Orange County", "California"): "SNA",
                                     ("Oregon Coast", "Oregon"): "ONP",
                                     ("Orlando", "Florida"): "MCO",
                                     ("Ottawa", "Ontario"): "YOW",
                                     ("Ottumwa", "Iowa"): "OTM",
                                     ("Outer Banks", "North Carolina"): "FFA",
                                     ("Owen Sound", "Ontario"): "YOS",
                                     ("Owensboro", "Kentucky"): "OWB",
                                     ("Oxford", "Uk"): "OXF",
                                     ("Palmdale", "California"): "PMD",
                                     ("Palms Prings", "California"): "PSP",
                                     ("Panama City", "Florida"): "PFN",
                                     ("Parkersburg", "West Virginia"): "PKB",
                                     ("Pennstate", "Pennsylvania"): "UNV",
                                     ("Pensacola", "Florida"): "PNS",
                                     ("Peoria", "Illinois"): "PIA",
                                     ("Perth", "Australia"): "PER",
                                     ("Peterborough", "Ontario"): "YPQ",
                                     ("Philadelphia", "Pennsylvania"): "PHL",
                                     ("Phoenix", "Arizona"): "PHX",
                                     ("Pittsburgh", "Pennsylvania"): "PIT",
                                     ("Plattsburgh", "New York"): "PBG",
                                     ("Poconos", "Pennsylvania"): "MPO",
                                     ("Port Huron", "Michigan"): "PHN",
                                     ("Portland", "Oregon"): "PDX",
                                     ("Portsmouth", "Maine"): "PWM",
                                     ("Portsmouth", "Virginia"): "ORF",
                                     ("Potsdam", "New York"): "MSS",
                                     ("Prescott", "Arizona"): "PRC",
                                     ("Prince George", "British Columbia"): "YXS",
                                     ("Provo", "Utah"): "PVU",
                                     ("Pueblo", "Colorado"): "PUB",
                                     ("Puerto Rico", "Puerto Rico"): "SJU",
                                     ("Pullman", "Washington"): "PUW",
                                     ("Quad Cities", "Iowa"): "MLI",
                                     ("Quebec", "Quebec"): "YQB",
                                     ("Quincy", "Illinois"): "UIN",
                                     ("Racine", "Wisconsin"): "RAC",
                                     ("Raleigh", "North Carolina"): "RDU",
                                     ("Reading", "Pennsylvania"): "RDG",
                                     ("Red Deer", "Alberta"): "YQF",
                                     ("Redding", "California"): "RDD",
                                     ("Reno", "Nevada"): "RNO",
                                     ("Richmond", "Virginia"): "RIC",
                                     ("Riverside", "California"): "ONT",
                                     ("Roanoke", "Virginia"): "ROA",
                                     ("Rochester", "New York"): "ROC",
                                     ("Rockford", "Illinois"): "RFD",
                                     ("Rockies", "Colorado"): "EGE",
                                     ("Roseburg", "Oregon"): "RBG",
                                     ("ST. Augustine", "Florida"): "UST",
                                     ("Sacramento", "California"): "SMF",
                                     ("Saginaw", "Michigan"): "MBS",
                                     ("Salem", "North Carolina"): "INT",
                                     ("Salem", "Oregon"): "SLE",
                                     ("Salt Lake City", "Utah"): "SLC",
                                     ("San Antonio", "Texas"): "SAT",
                                     ("San Bernardino", "California"): "ONT",
                                     ("San Diego", "California"): "SAN",
                                     ("San Fernando", "California"): "BUR",
                                     ("San Francisco", "California"): "SFO",
                                     ("San Jose", "California"): "SJC",
                                     ("San Luis Obispo", "California"): "SBP",
                                     ("San Marcos", "Texas"): "HYI",
                                     ("Sandusky", "Ohio"): "SKY",
                                     ("Santa Barbara", "California"): "SBA",
                                     ("Santa Cruz", "California"): "WVI",
                                     ("Santa Maria", "California"): "SMX",
                                     ("Santafe", "New Mexico"): "SAF",
                                     ("Sarasota", "Florida"): "SRQ",
                                     ("Sarnia", "Ontario"): "YZR",
                                     ("Saskatoon", "Saskatchewan"): "YXE",
                                     ("Sault", "Ontario"): "YAM",
                                     ("Savannah", "Georgia"): "SAV",
                                     ("Scotts Bluff", "Nebraska"): "BFF",
                                     ("Scranton", "Pennsylvania"): "AVP",
                                     ("Seattle", "Washington"): "SEA",
                                     ("Sheboygan", "Wisconsin"): "SBM",
                                     ("Sheffield", "Uk"): "DSA",
                                     ("Shoals", "Alabama"): "MSL",
                                     ("Showlow", "Arizona"): "SOW",
                                     ("Shreveport", "Louisiana"): "SHV",
                                     ("Sierra Vista", "Arizona"): "FHU",
                                     ("Sioux City", "Iowa"): "SUX",
                                     ("Siskiyou", "California"): "SIY",
                                     ("Skeena", "British Columbia"): "YYD",
                                     ("South Bend", "Indiana"): "SBN",
                                     ("South Coast", "Massachusetts"): "EWB",
                                     ("South Jersey", "New Jersey"): "MIV",
                                     ("Southeast Missouri", "Missouri"): "CGI",
                                     ("Southern Maryland", "district of columbia"): "2W6",
                                     ("Southwest Michigan", "Michigan"): "BEH",
                                     ("Southwest Virginia", "Virginia"): "MKJ",
                                     ("Space Coast", "Florida"): "TIX",
                                     ("Spokane", "Washington"): "GEG",
                                     ("Springfield", "Massachusetts"): "CEF",
                                     ("Springfield", "Missouri"): "SGF",
                                     ("St Cloud", "Minnesota"): "STC",
                                     ("St George", "Utah"): "SGU",
                                     ("St Joseph", "Missouri"): "STJ",
                                     ("St Louis", "Missouri"): "STL",
                                     ("St Paul", "Minnesota"): "MSP",
                                     ("Statesboro", "Georgia"): "TBR",
                                     ("Stillwater", "Oklahoma"): "SWO",
                                     ("Sudbury", "Ontario"): "YSB",
                                     ("Suffolk", "Virginia"): "ORF",
                                     ("Sunshine", "British Columbia"): "YHS",
                                     ("Susanville", "California"): "SVE",
                                     ("Sydney", "Australia"): "SYD",
                                     ("Syracuse", "New York"): "SYR",
                                     ("Tacoma", "Washington"): "TCM",
                                     ("Tallahassee", "Florida"): "TLH",
                                     ("Tampa", "Florida"): "TPA",
                                     ("Terre Haute", "Indiana"): "HUF",
                                     ("Texarkana", "Texas"): "TXK",
                                     ("Texoma", "Texas"): "GYI",
                                     ("Thunderbay", "Ontario"): "YQT",
                                     ("Toledo", "Ohio"): "TOL",
                                     ("Topeka", "Kansas"): "FOE",
                                     ("Toronto", "Ontario"): "YYZ",
                                     ("Treasure Coast", "Florida"): "VRB",
                                     ("Tri-cities", "Washington"): "PSC",
                                     ("Trois Rivieres", "Quebec"): "YRQ",
                                     ("Tucson", "Arizona"): "TUS",
                                     ("Tulsa", "Oklahoma"): "TUL",
                                     ("Tuscaloosa", "Alabama"): "TCL",
                                     ("Tuscarawas", "Ohio"): "PHD",
                                     ("Twin Falls", "Idaho"): "TWF",
                                     ("Twintiers", "New York"): "OLE",
                                     ("Tyler", "Texas"): "TYR",
                                     ("Upper Peninsula", "Michigan"): "MQT",
                                     ("Utica", "New York"): "UCA",
                                     ("Valdosta", "Georgia"): "VLD",
                                     ("Vancouver", "British Columbia"): "YVR",
                                     ("Ventura", "California"): "OXR",
                                     ("Victoria", "British Columbia"): "YYJ",
                                     ("Virginia Beach", "Virginia"): "ORF",
                                     ("Visalia", "California"): "VIS",
                                     ("Waco", "Texas"): "ACT",
                                     ("Wales", "Uk"): "CWL",
                                     ("Washington DC", "district of columbia"): "IAD",
                                     ("Waterloo", "Iowa"): "ALO",
                                     ("Watertown", "New York"): "ART",
                                     ("Wausau", "Wisconsin"): "AUW",
                                     ("Wenatchee", "Washington"): "EAT",
                                     ("West Kentucky", "Kentucky"): "PAH",
                                     ("West Palm Beach", "Florida"): "PBI",
                                     ("West Slope", "Colorado"): "GJT",
                                     ("Western Maryland", "Maryland"): "CBE",
                                     ("Wheeling", "West Virginia"): "HLG",
                                     ("Whistler", "British Columbia"): "YWS",
                                     ("Wichita Falls", "Texas"): "SPS",
                                     ("Wichita", "Kansas"): "ICT",
                                     ("Williamsport", "Pennsylvania"): "IPT",
                                     ("Wilmington", "North Carolina"): "ILG",
                                     ("Windsor", "Ontario"): "YQG",
                                     ("Worcester", "Massachusetts"): "ORH",
                                     ("Yakima", "Washington"): "YKM",
                                     ("York", "Pennsylvania"): "THV",
                                     ("Youngstown", "Ohio"): "YNG",
                                     ("Yuma", "Arizona"): "YUM",
                                     ("Zanesville", "Ohio"): "ZZV",
                                     ("Albany", "Georgia"): "ABY",
                                     ("Athens", "Georgia"): "AHN",
                                     ("Baton Rouge", "Lousiana"): "BTR",
                                     ("Bloomington", "Illinois"): "BMI",
                                     ("Columbus", "Georgia"): "CSG",
                                     ("Cumberland Valley", "Pennsylvania"): "N68",
                                     ("Fayetteville", "Arkansas"): "XNA",
                                     ("Jackson", "Michigan"): "JXN",
                                     ("Lafayette", "Indiana"): "LAF",
                                     ("Lake Charles", "Lousiana"): "LCH",
                                     ("Monroe", "Lousiana"): "MLU",
                                     ("Monroe", "louisiana"): "MLU",
                                     ("New Orleans", "Lousiana"): "MSY",
                                     ("Regina", "Saskatchewan"): "YQR",
                                     ("Richmond", "Indiana"): "RID",
                                     ("Rochester", "Minnesota"): "RST",
                                     ("Saguenay", "Quebec"): "YBG",
                                     ("Sherbrooke", "Quebec"): "YSC",
                                     ("Shreveport", "Lousiana"): "SHV",
                                     ("Southern West Virgin", "West Virginia"): "BKW",
                                     ("Springfield", "Illinois"): "SPI",
                                     ("Victoria", "Texas"): "VCT"}


def escorts181920_citystate_to_marketid(city, state):
    """http://longisland.escorts181920.com/FemaleEscorts/s-mny-oo-chics-but-oo-nn-lik-oo-me-19/40317377"""
    return escorts181920_sitekey_to_marketid.get((city, state), None)

def determineMarketEscorts181920(url, title, city, state):
    return marketid_to_market_tuple("city,state", escorts181920_citystate_to_marketid(city,state))

def determineMarketEscortadsxxx(url, title, city, state):
    return determineMarketEscorts181920(url, title, city, state)

def determineMarketEscortsinca(url, title, city, state):
    return determineMarketEscorts181920(url, title, city, state)

def determineMarketEscortsintheus(url, title, city, state):
    return determineMarketEscorts181920(url, title, city, state)

### LIVEESCORTREVIEWS

liveescortreviews_sitekey_to_marketid = {
                                         "akron": "CAK",
                                         "albany": "ALB",
                                         "albuquerque": "ABQ",
                                         "anchorage": "ANC",
                                         "atlanta": "ATL",
                                         "austin": "AUS",
                                         "baltimore": "BWI",
                                         "batonrouge": "BTR",
                                         "birmingham": "BHM",
                                         "boston": "BOS",
                                         "bronx": "JFK",
                                         "brooklyn": "JFK",
                                         "buffalo": "BUF",
                                         "burlington": "BTV",
                                         "calgary": "YYC",
                                         "centraljersey": "47N",
                                         "charleston": "CHS",
                                         "charlotte": "CLT",
                                         "chattanooga": "CHA",
                                         "chesapeake": "ORF",
                                         "chicago": "ORD",
                                         "cincinnati": "CVG",
                                         "cleveland": "CLE",
                                         "coloradosprings": "COS",
                                         "columbia": "CAE",
                                         "columbus": "CMH",
                                         "daytona": "DAB",
                                         "delaware": "ILG",
                                         "denver": "DEN",
                                         "desmoines": "DSM",
                                         "detroit": "DTW",
                                         "eastbay": "OAK",
                                         "edmonton": "YEG",
                                         "everett": "PAE",
                                         "fairfield": "HVN",
                                         "fortmyers": "RSW",
                                         "ftlauderdale": "FLL",
                                         "greensboro": "GSO",
                                         "greenville": "GSP",
                                         "hamilton": "YHM",
                                         "hartford": "HFD",
                                         "honolulu": "HNL",
                                         "houston": "IAH",
                                         "hudsonvalley": "SWF",
                                         "huntsville": "HSV",
                                         "indianapolis": "IND",
                                         "inlandempire": "ONT",
                                         "jacksonville": "JAX",
                                         "jerseyshore": "ACY",
                                         "kc": "MCI",
                                         "knoxville": "TYS",
                                         "lasvegas": "LAS",
                                         "lexington": "LEX",
                                         "littlerock": "LIT",
                                         "longbeach": "LGB",
                                         "longisland": "ISP",
                                         "losangeles": "LAX",
                                         "louisville": "SDF",
                                         "madison": "MSN",
                                         "maine": "PWM",
                                         "manhattan": "JFK",
                                         "memphis": "MEM",
                                         "miami": "MIA",
                                         "milwaukee": "MKE",
                                         "minneapolis": "MSP",
                                         "minot": "MOT",
                                         "montreal": "YUL",
                                         "myrtlebeach": "MYR",
                                         "nashville": "BNA",
                                         "newhampshire": "MHT",
                                         "newhaven": "HVN",
                                         "newlondon": "GON",
                                         "neworleans": "MSY",
                                         "norfolk": "ORF",
                                         "northbay": "STS",
                                         "northeasttexas": "DFW",
                                         "northjersey": "EWR",
                                         "nova": "IAD",
                                         "oklahomacity": "OKC",
                                         "omaha": "OMA",
                                         "orangecounty": "SNA",
                                         "orlando": "MCO",
                                         "ottawa": "YOW",
                                         "palmdale": "PMD",
                                         "palmsprings": "PSP",
                                         "panamacity": "PFN",
                                         "pensacola": "PNS",
                                         "philadelphia": "PHL",
                                         "phoenix": "PHX",
                                         "pittsburgh": "PIT",
                                         "portland": "PDX",
                                         "providence": "PVD",
                                         "queens": "JFK",
                                         "raleigh": "RDU",
                                         "reno": "RNO",
                                         "richmond": "RIC",
                                         "sacramento": "SMF",
                                         "saltlakecity": "SLC",
                                         "sanantonio": "SAT",
                                         "sandiego": "SAN",
                                         "sanfernandovalley": "BUR",
                                         "sangabrielvalley": "EMT",
                                         "sanjose": "SJC",
                                         "santabarbara": "SBA",
                                         "sarasota": "SRQ",
                                         "saskatoon": "YXE",
                                         "seattle": "SEA",
                                         "sf": "SFO",
                                         "southbend": "SBN",
                                         "southcoast": "EWB",
                                         "southernmaryland": "2W6",
                                         "southjersey": "MIV",
                                         "spacecoast": "TIX",
                                         "statenisland": "JFK",
                                         "stlouis": "STL",
                                         "syracuse": "SYR",
                                         "tacoma": "TCM",
                                         "tampa": "TPA",
                                         "toronto": "YYZ",
                                         "tucson": "TUS",
                                         "tulsa": "TUL",
                                         "vancouver": "YVR",
                                         "ventura": "OXR",
                                         "virginiabeach": "ORF",
                                         "washingtondc": "IAD",
                                         "westchester": "HPN",
                                         "westpalmbeach": "PBI",
                                         "westvirginia": "CRW",
                                         "wichita": "ICT",
                                         "winnipeg": "YWG",
                                         "worcester": "ORH"}

def liveescortreviews_url_to_sitekey(url):
    """http://liveescortreviews.com/ad/daytona/702-637-9016/5/3463"""
    (scheme, netloc, path, params, query, fragment) = urlparse(url)
    sitekey = path.split('/')[2]
    return sitekey

def determineMarketLiveescortreviews(url, title, city, state):
    return marketid_to_market_tuple("url", liveescortreviews_sitekey_to_marketid[liveescortreviews_url_to_sitekey(url)])

def determineMarketMyproviderguideforum(url, title, city, state):
    pass

def determineMarketUsasexguide(url, title, city, state):
    pass

def determineMarketEroticreview(url, title, city, state):
    pass

def determineMarketAdultsearch(url, title, city, state):
    pass

def determineMarketHappymassage(url, title, city, state):
    pass

def determineMarketUtopiaguide(url, title, city, state):
    pass

def determineMarketMissingkids(url, title, city, state):
    pass

def determineMarketAlibaba(url, title, city, state):
    pass

def determineMarketJustlanded(url, title, city, state):
    pass

def determineMarketGmdu(url, title, city, state):
    pass

def determineMarketTradekey(url, title, city, state):
    pass

def determineMarketManpowervacancy(url, title, city, state):
    pass

def determineMarketGulfjobsbank(url, title, city, state):
    pass

def determineMarketEc21(url, title, city, state):
    pass

handlers_by_source = {
                      "backpage": determineMarketBackpage,
                      "craigslist": determineMarketCraigslist,
                      "classivox": determineMarketClassivox,
                      "myproviderguide": determineMarketMyproviderguide,
                      "naughtyreviews": determineMarketNaughtyreviews,
                      "redbook": determineMarketRedbook,
                      "cityvibe": determineMarketCityvibe,
                      "massagetroll": determineMarketMassagetroll,
                      "redbook_forum": determineMarketRedbook_forum,
                      "cityxguide": determineMarketCityxguide,
                      "cityxguideforum": determineMarketCityxguideforum,
                      "rubads": determineMarketRubads,
                      "anunico": determineMarketAnunico,
                      "sipsap": determineMarketSipsap,
                      "escortsincollege": determineMarketEscortsincollege,
                      "escortphonelist": determineMarketEscortphonelist,
                      "eroticmugshots": determineMarketEroticmugshots,
                      "escortadsxxx": determineMarketEscortadsxxx,
                      "escortsinca": determineMarketEscortsinca,
                      "escortsintheus": determineMarketEscortsintheus,
                      "liveescortreviews": determineMarketLiveescortreviews,
                      "myproviderguideforum": determineMarketMyproviderguideforum,
                      "usasexguide": determineMarketUsasexguide,
                      "eroticreview": determineMarketEroticreview,
                      "adultsearch": determineMarketAdultsearch,
                      "happymassage": determineMarketHappymassage,
                      "utopiaguide": determineMarketUtopiaguide,
                      "missingkids": determineMarketMissingkids,
                      "alibaba": determineMarketAlibaba,
                      "justlanded": determineMarketJustlanded,
                      "gmdu": determineMarketGmdu,
                      "tradekey": determineMarketTradekey,
                      "manpowervacancy": determineMarketManpowervacancy,
                      "gulfjobsbank": determineMarketGulfjobsbank,
                      "ec21": determineMarketEc21}

def determineMarket(source, url, title, city, state, idx=0):
    try:
        source = int(source)
    except:
        pass
    try:
        handler = handlers_by_source[sources_by_id.get(source, source)]
        l = handler(url, title, city, state)
        return str(l) if idx==None else l[idx]
    except:
        pass
    return None

'''
### BOILERPLATE

boilerplate_sitekey_to_marketid = {"zurich": "ZRH"}

def boilerplate_url_to_sitekey(url):
    """http://longisland.boilerplate.com/FemaleEscorts/s-mny-oo-chics-but-oo-nn-lik-oo-me-19/40317377"""
    (scheme, netloc, path, params, query, fragment) = urlparse(url)
    sitekey = netloc.split('.')[0]
    return sitekey

def determineMarketBoilerplate(url, title, city, state):
    return marketid_to_market_tupleboilerplate_sitekey_to_marketid[boilerplate_url_to_sitekey(url)])
'''

"""intended use:

create python transform 'marketinfo':

return determineMarket(getValue('sources_id'), getValue('url'), getValue('title'), getValue('city'), getValue('state'))

"""

escortadsxxx_sitekey_to_marketid = escorts181920_sitekey_to_marketid
escortsinca_sitekey_to_marketid = escorts181920_sitekey_to_marketid
escortsintheus_sitekey_to_marketid = escorts181920_sitekey_to_marketid

eroticmugshots_sitekey_to_marketid = eroticmugshots_massagetroll_sitekey_to_marketid 
massagetroll_sitekey_to_marketid = eroticmugshots_massagetroll_sitekey_to_marketid 

# backpage_sitekey_to_marketid
# craigslist_sitekey_to_marketid 
# classivox_sitekey_to_marketid 
# myproviderguide_sitekey_to_marketid 
# naughtyreviews_sitekey_to_marketid 
# cityvibe_sitekey_to_marketid 
# escortsincollege_sitekey_to_marketid 
# escortphonelist_sitekey_to_marketid
# eroticmugshots_massagetroll_sitekey_to_marketid 
# escortadsxxx_sitekey_to_marketid
# escortsinca_sitekey_to_marketid
# escortsintheus_sitekey_to_marketid
# liveescortreviews_sitekey_to_marketid 

l = []

# url
for k,v in backpage_sitekey_to_marketid.iteritems():
    l.append(['http://dig.isi.edu/sourcemarket/backpage/%s' % k, 'http://dig.isi.edu/market/%s' % v])

# url
for k,v in craigslist_sitekey_to_marketid.iteritems():
    l.append(['http://dig.isi.edu/sourcemarket/craigslist/%s' % k, 'http://dig.isi.edu/market/%s' %v])

# url
for k,v in classivox_sitekey_to_marketid.iteritems():
    l.append(['http://dig.isi.edu/sourcemarket/classivox/%s' % k, 'http://dig.isi.edu/market/%s' %v])

# url
for k,v in myproviderguide_sitekey_to_marketid.iteritems():
    l.append(['http://dig.isi.edu/sourcemarket/myproviderguide/%s' % k, 'http://dig.isi.edu/market/%s' %v])

# 1,2,or3-tuple
for k,v in naughtyreviews_sitekey_to_marketid.iteritems():
    l.append(['http://dig.isi.edu/sourcemarket/naughtyreviews/%s' % '/'.join(k), 'http://dig.isi.edu/market/%s' %v])

# url
for k,v in cityvibe_sitekey_to_marketid.iteritems():
    l.append(['http://dig.isi.edu/sourcemarket/cityvibe/%s' % k, 'http://dig.isi.edu/market/%s' %v])

# "city, state" string
for k,v in escortsincollege_sitekey_to_marketid.iteritems():
    l.append(['http://dig.isi.edu/sourcemarket/escortsincollege/%s' % k.replace(',','/').replace(' ',''), 'http://dig.isi.edu/market/%s' %v])

# "city, state" string
for k,v in escortphonelist_sitekey_to_marketid.iteritems():
    l.append(['http://dig.isi.edu/sourcemarket/escortphonelist/%s' % k.replace(',','/').replace(' ',''), 'http://dig.isi.edu/market/%s' %v])

# url
for k,v in eroticmugshots_sitekey_to_marketid.iteritems():
    l.append(['http://dig.isi.edu/sourcemarket/eroticmugshots/%s' % k, 'http://dig.isi.edu/market/%s' %v])

# url
for k,v in massagetroll_sitekey_to_marketid.iteritems():
    l.append(['http://dig.isi.edu/sourcemarket/eroticmugshots/%s' % k, 'http://dig.isi.edu/market/%s' %v])

# ('City', 'State') 2-tuple
for k,v in escortadsxxx_sitekey_to_marketid.iteritems():
    l.append(['http://dig.isi.edu/sourcemarket/escortadsxxx/%s/%s' % (k[0].replace(' ',''), k[1].replace(' ','')), 'http://dig.isi.edu/market/%s' %v])

# ('City', 'State') 2-tuple
for k,v in escortsinca_sitekey_to_marketid.iteritems():
    l.append(['http://dig.isi.edu/sourcemarket/escortsinca/%s/%s' % (k[0].replace(' ',''), k[1].replace(' ','')), 'http://dig.isi.edu/market/%s' %v])

# ('City', 'State') 2-tuple
for k,v in escortsintheus_sitekey_to_marketid.iteritems():
    l.append(['http://dig.isi.edu/sourcemarket/escortsintheus/%s/%s' % (k[0].replace(' ',''), k[1].replace(' ','')), 'http://dig.isi.edu/market/%s' %v])

# url sitekey
for k,v in liveescortreviews_sitekey_to_marketid.iteritems():
    l.append(['http://dig.isi.edu/sourcemarket/liveescortreviews/%s' % k, 'http://dig.isi.edu/market/%s' %v])

print l[0]
print len(l)

import json
with open('sitekeymappings.json', 'w') as f:
    json.dump(l, f, indent=4)
